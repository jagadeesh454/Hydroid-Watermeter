/*! For license information please see bundle.js.LICENSE.txt */
var CustomFit;(()=>{var e={669:(e,t,r)=>{e.exports=r(609)},448:(e,t,r)=>{"use strict";var s=r(867),i=r(26),n=r(327),o=r(109),a=r(985),c=r(61);e.exports=function(e){return new Promise((function(t,l){var u=e.data,p=e.headers;s.isFormData(u)&&delete p["Content-Type"];var h=new XMLHttpRequest;if(e.auth){var d=e.auth.username||"",f=e.auth.password||"";p.Authorization="Basic "+btoa(d+":"+f)}if(h.open(e.method.toUpperCase(),n(e.url,e.params,e.paramsSerializer),!0),h.timeout=e.timeout,h.onreadystatechange=function(){if(h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in h?o(h.getAllResponseHeaders()):null,s={data:e.responseType&&"text"!==e.responseType?h.response:h.responseText,status:h.status,statusText:h.statusText,headers:r,config:e,request:h};i(t,l,s),h=null}},h.onerror=function(){l(c("Network Error",e,null,h)),h=null},h.ontimeout=function(){l(c("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",h)),h=null},s.isStandardBrowserEnv()){var m=r(372),g=(e.withCredentials||a(e.url))&&e.xsrfCookieName?m.read(e.xsrfCookieName):void 0;g&&(p[e.xsrfHeaderName]=g)}if("setRequestHeader"in h&&s.forEach(p,(function(e,t){void 0===u&&"content-type"===t.toLowerCase()?delete p[t]:h.setRequestHeader(t,e)})),e.withCredentials&&(h.withCredentials=!0),e.responseType)try{h.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&h.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){h&&(h.abort(),l(e),h=null)})),void 0===u&&(u=null),h.send(u)}))}},609:(e,t,r)=>{"use strict";var s=r(867),i=r(849),n=r(321),o=r(655);function a(e){var t=new n(e),r=i(n.prototype.request,t);return s.extend(r,n.prototype,t),s.extend(r,t),r}var c=a(o);c.Axios=n,c.create=function(e){return a(s.merge(o,e))},c.Cancel=r(263),c.CancelToken=r(972),c.isCancel=r(502),c.all=function(e){return Promise.all(e)},c.spread=r(713),e.exports=c,e.exports.default=c},263:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},972:(e,t,r)=>{"use strict";var s=r(263);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new s(e),t(r.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},502:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},321:(e,t,r)=>{"use strict";var s=r(655),i=r(867),n=r(782),o=r(572);function a(e){this.defaults=e,this.interceptors={request:new n,response:new n}}a.prototype.request=function(e){"string"==typeof e&&(e=i.merge({url:arguments[0]},arguments[1])),(e=i.merge(s,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[o,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)r=r.then(t.shift(),t.shift());return r},i.forEach(["delete","get","head","options"],(function(e){a.prototype[e]=function(t,r){return this.request(i.merge(r||{},{method:e,url:t}))}})),i.forEach(["post","put","patch"],(function(e){a.prototype[e]=function(t,r,s){return this.request(i.merge(s||{},{method:e,url:t,data:r}))}})),e.exports=a},782:(e,t,r)=>{"use strict";var s=r(867);function i(){this.handlers=[]}i.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){s.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},61:(e,t,r)=>{"use strict";var s=r(481);e.exports=function(e,t,r,i,n){var o=new Error(e);return s(o,t,r,i,n)}},572:(e,t,r)=>{"use strict";var s=r(867),i=r(527),n=r(502),o=r(655),a=r(793),c=r(303);function l(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return l(e),e.baseURL&&!a(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=s.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),s.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||o.adapter)(e).then((function(t){return l(e),t.data=i(t.data,t.headers,e.transformResponse),t}),(function(t){return n(t)||(l(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},481:e=>{"use strict";e.exports=function(e,t,r,s,i){return e.config=t,r&&(e.code=r),e.request=s,e.response=i,e}},26:(e,t,r)=>{"use strict";var s=r(61);e.exports=function(e,t,r){var i=r.config.validateStatus;r.status&&i&&!i(r.status)?t(s("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},527:(e,t,r)=>{"use strict";var s=r(867);e.exports=function(e,t,r){return s.forEach(r,(function(r){e=r(e,t)})),e}},655:(e,t,r)=>{"use strict";var s=r(867),i=r(16),n={"Content-Type":"application/x-www-form-urlencoded"};function o(e,t){!s.isUndefined(e)&&s.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var a,c={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process)&&(a=r(448)),a),transformRequest:[function(e,t){return i(t,"Content-Type"),s.isFormData(e)||s.isArrayBuffer(e)||s.isBuffer(e)||s.isStream(e)||s.isFile(e)||s.isBlob(e)?e:s.isArrayBufferView(e)?e.buffer:s.isURLSearchParams(e)?(o(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):s.isObject(e)?(o(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};s.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),s.forEach(["post","put","patch"],(function(e){c.headers[e]=s.merge(n)})),e.exports=c},849:e=>{"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),s=0;s<r.length;s++)r[s]=arguments[s];return e.apply(t,r)}}},327:(e,t,r)=>{"use strict";var s=r(867);function i(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var n;if(r)n=r(t);else if(s.isURLSearchParams(t))n=t.toString();else{var o=[];s.forEach(t,(function(e,t){null!=e&&(s.isArray(e)?t+="[]":e=[e],s.forEach(e,(function(e){s.isDate(e)?e=e.toISOString():s.isObject(e)&&(e=JSON.stringify(e)),o.push(i(t)+"="+i(e))})))})),n=o.join("&")}return n&&(e+=(-1===e.indexOf("?")?"?":"&")+n),e}},303:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},372:(e,t,r)=>{"use strict";var s=r(867);e.exports=s.isStandardBrowserEnv()?{write:function(e,t,r,i,n,o){var a=[];a.push(e+"="+encodeURIComponent(t)),s.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),s.isString(i)&&a.push("path="+i),s.isString(n)&&a.push("domain="+n),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},793:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},985:(e,t,r)=>{"use strict";var s=r(867);e.exports=s.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function i(e){var s=e;return t&&(r.setAttribute("href",s),s=r.href),r.setAttribute("href",s),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=i(window.location.href),function(t){var r=s.isString(t)?i(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},16:(e,t,r)=>{"use strict";var s=r(867);e.exports=function(e,t){s.forEach(e,(function(r,s){s!==t&&s.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[s])}))}},109:(e,t,r)=>{"use strict";var s=r(867),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,n,o={};return e?(s.forEach(e.split("\n"),(function(e){if(n=e.indexOf(":"),t=s.trim(e.substr(0,n)).toLowerCase(),r=s.trim(e.substr(n+1)),t){if(o[t]&&i.indexOf(t)>=0)return;o[t]="set-cookie"===t?(o[t]?o[t]:[]).concat([r]):o[t]?o[t]+", "+r:r}})),o):o}},713:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},867:(e,t,r)=>{"use strict";var s=r(849),i=r(778),n=Object.prototype.toString;function o(e){return"[object Array]"===n.call(e)}function a(e){return null!==e&&"object"==typeof e}function c(e){return"[object Function]"===n.call(e)}function l(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),o(e))for(var r=0,s=e.length;r<s;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:o,isArrayBuffer:function(e){return"[object ArrayBuffer]"===n.call(e)},isBuffer:i,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===n.call(e)},isFile:function(e){return"[object File]"===n.call(e)},isBlob:function(e){return"[object Blob]"===n.call(e)},isFunction:c,isStream:function(e){return a(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:l,merge:function e(){var t={};function r(r,s){"object"==typeof t[s]&&"object"==typeof r?t[s]=e(t[s],r):t[s]=r}for(var s=0,i=arguments.length;s<i;s++)l(arguments[s],r);return t},extend:function(e,t,r){return l(t,(function(t,i){e[i]=r&&"function"==typeof t?s(t,r):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},778:e=>{e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},20:e=>{"use strict";var t="%[a-f0-9]{2}",r=new RegExp(t,"gi"),s=new RegExp("("+t+")+","gi");function i(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var r=e.slice(0,t),s=e.slice(t);return Array.prototype.concat.call([],i(r),i(s))}function n(e){try{return decodeURIComponent(e)}catch(n){for(var t=e.match(r),s=1;s<t.length;s++)t=(e=i(t,s).join("")).match(r);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},r=s.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch(e){var i=n(r[0]);i!==r[0]&&(t[r[0]]=i)}r=s.exec(e)}t["%C2"]="�";for(var o=Object.keys(t),a=0;a<o.length;a++){var c=o[a];e=e.replace(new RegExp(c,"g"),t[c])}return e}(e)}}},418:e=>{"use strict";var t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function i(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var s={};return"abcdefghijklmnopqrst".split("").forEach((function(e){s[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},s)).join("")}catch(e){return!1}}()?Object.assign:function(e,n){for(var o,a,c=i(e),l=1;l<arguments.length;l++){for(var u in o=Object(arguments[l]))r.call(o,u)&&(c[u]=o[u]);if(t){a=t(o);for(var p=0;p<a.length;p++)s.call(o,a[p])&&(c[a[p]]=o[a[p]])}}return c}},563:(e,t,r)=>{"use strict";var s=r(610),i=r(418),n=r(20);function o(e,t){return t.encode?t.strict?s(e):encodeURIComponent(e):e}function a(e){return Array.isArray(e)?e.sort():"object"==typeof e?a(Object.keys(e)).sort((function(e,t){return Number(e)-Number(t)})).map((function(t){return e[t]})):e}function c(e){var t=e.indexOf("?");return-1===t?"":e.slice(t+1)}function l(e,t){var r=function(e){var t;switch(e.arrayFormat){case"index":return function(e,r,s){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===s[e]&&(s[e]={}),s[e][t[1]]=r):s[e]=r};case"bracket":return function(e,r,s){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==s[e]?s[e]=[].concat(s[e],r):s[e]=[r]:s[e]=r};default:return function(e,t,r){void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(t=i({arrayFormat:"none"},t)),s=Object.create(null);return"string"!=typeof e?s:(e=e.trim().replace(/^[?#&]/,""))?(e.split("&").forEach((function(e){var t=e.replace(/\+/g," ").split("="),i=t.shift(),o=t.length>0?t.join("="):void 0;o=void 0===o?null:n(o),r(n(i),o,s)})),Object.keys(s).sort().reduce((function(e,t){var r=s[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=a(r):e[t]=r,e}),Object.create(null))):s}t.extract=c,t.parse=l,t.stringify=function(e,t){!1===(t=i({encode:!0,strict:!0,arrayFormat:"none"},t)).sort&&(t.sort=function(){});var r=function(e){switch(e.arrayFormat){case"index":return function(t,r,s){return null===r?[o(t,e),"[",s,"]"].join(""):[o(t,e),"[",o(s,e),"]=",o(r,e)].join("")};case"bracket":return function(t,r){return null===r?o(t,e):[o(t,e),"[]=",o(r,e)].join("")};default:return function(t,r){return null===r?o(t,e):[o(t,e),"=",o(r,e)].join("")}}}(t);return e?Object.keys(e).sort(t.sort).map((function(s){var i=e[s];if(void 0===i)return"";if(null===i)return o(s,t);if(Array.isArray(i)){var n=[];return i.slice().forEach((function(e){void 0!==e&&n.push(r(s,e,n.length))})),n.join("&")}return o(s,t)+"="+o(i,t)})).filter((function(e){return e.length>0})).join("&"):""},t.parseUrl=function(e,t){return{url:e.split("?")[0]||"",query:l(c(e),t)}}},610:e=>{"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}},75:e=>{for(var t=[],r=0;r<256;++r)t[r]=(r+256).toString(16).substr(1);e.exports=function(e,r){var s=r||0,i=t;return[i[e[s++]],i[e[s++]],i[e[s++]],i[e[s++]],"-",i[e[s++]],i[e[s++]],"-",i[e[s++]],i[e[s++]],"-",i[e[s++]],i[e[s++]],"-",i[e[s++]],i[e[s++]],i[e[s++]],i[e[s++]],i[e[s++]],i[e[s++]]].join("")}},217:e=>{var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var r=new Uint8Array(16);e.exports=function(){return t(r),r}}else{var s=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),s[t]=e>>>((3&t)<<3)&255;return s}}},570:(e,t,r)=>{var s,i,n=r(217),o=r(75),a=0,c=0;e.exports=function(e,t,r){var l=t&&r||0,u=t||[],p=(e=e||{}).node||s,h=void 0!==e.clockseq?e.clockseq:i;if(null==p||null==h){var d=n();null==p&&(p=s=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==h&&(h=i=16383&(d[6]<<8|d[7]))}var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:c+1,g=f-a+(m-c)/1e4;if(g<0&&void 0===e.clockseq&&(h=h+1&16383),(g<0||f>a)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=f,c=m,i=h;var _=(1e4*(268435455&(f+=122192928e5))+m)%4294967296;u[l++]=_>>>24&255,u[l++]=_>>>16&255,u[l++]=_>>>8&255,u[l++]=255&_;var v=f/4294967296*1e4&268435455;u[l++]=v>>>8&255,u[l++]=255&v,u[l++]=v>>>24&15|16,u[l++]=v>>>16&255,u[l++]=h>>>8|128,u[l++]=255&h;for(var y=0;y<6;++y)u[l+y]=p[y];return t||o(u)}}},t={};function r(s){var i=t[s];if(void 0!==i)return i.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};(()=>{"use strict";r.r(s),r.d(s,{CFEvent:()=>m,CFUser:()=>d,default:()=>y});var e=r(669),t=r.n(e),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=r(563),o=/^(\w+:\/\/[^/?]+)?(.*?)(\?.+)?$/,a=/^(\/\/[^/?]+)(.*?)(\?.+)?$/;function c(e,t){var r=t.protocolRelative&&e.match(a)||e.match(o)||[];return{beforePathname:r[1]||"",pathname:(r[2]||"").replace(/^\/+/,"").replace(/\/+$/,"").replace(/\/+/g,"/"),afterPathname:r[3]||""}}function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var s=t[t.length-1],o=void 0;s&&"object"===(void 0===s?"undefined":i(s))&&(o=s,t=t.slice(0,-1)),o=Object.assign({leadingSlash:!0,trailingSlash:!1,protocolRelative:!1},o);var a=t.filter((function(e){return"string"==typeof e||"number"==typeof e})).join("/"),l=c(a,o),u=l.beforePathname,p=l.pathname,h=l.afterPathname,d="";u?d+=u+(p?"/":""):o.leadingSlash&&(d+="/"),d+=p,o.trailingSlash&&!d.endsWith("/")&&(d+="/");var f=Object.assign({},n.parse(h,o.queryOptions),o.query),m=n.stringify(f,o.queryOptions);return m&&(d+="?"+m),d}var u=r(570),p=r.n(u);class h{constructor(e){this.baseURL="https://api.customfit.ai/",this.accessToken=e,t().defaults.headers.common={"Content-Type":"application/x-www-form-urlencoded"}}send(e,r,s={},i=!1){let n=l(this.baseURL,r,{trailingSlash:!0}),o=[],a={cfenc:this.accessToken},c="";if("POST"===e?(o["Content-Type"]="application/x-www-form-urlencoded",c=JSON.stringify(s)):Object.keys(s).length&&s.constructor===Object&&(n=l(n,{trailingSlash:!0,query:s})),"POST"===e&&i){var u=new Blob([c],{type:"application/x-www-form-urlencoded"});return navigator.sendBeacon(n+"?cfenc="+this.accessToken,u),Promise.resolve({})}return t()(n,{method:e,data:c,params:a,headers:o}).then((e=>e.status>=400?Promise.reject({status:e.status,message:e.statusText}):e.status>=200&&e.status<=202?e.data:{}),(e=>Promise.reject({status:e.response.status,message:e.message,data:e.response.data,request_data:data})))}}class d{constructor(e){this.private_fields=e.private_fields,this.session_fields=e.session_fields,this.hs_fields=e.hs_fields,this.user_customer_id=e.user_customer_id,this.anonymous=e.anonymous,this.user_id=e.user_id,this.device_id=e.device_id,this.tags=e.tags,this.latest_session_id="",this.properties=e.properties,this.email=e.email,this.sdk_generated_user_customer_id=e.sdk_generated_user_customer_id,e.utm_source&&(this.utm_source=e.utm_source),e.utm_medium&&(this.utm_medium=e.utm_medium),e.utm_campaign&&(this.utm_campaign=e.utm_campaign),e.utm_term&&(this.utm_term=e.utm_term),e.utm_content&&(this.utm_content=e.utm_content),this.initHubspotUTKIfSet()}initHubspotUTKIfSet(){if(cf_is_hubspot_enabled&&null==this.properties.hubspotutk){const r=`; ${document.cookie}`.split("; hubspotutk=");for(var e=r.length;e>0;e--){var t=r[e-1].split(";").shift();if(t&&t.length>0){this.properties.hubspotutk=t;break}}}}isHubspotUTKExtracted(){return!(null==this.properties.hubspotutk)}validateBuild(e){return String(e.constructor)===String(d.Builder)}static get Builder(){return class{constructor(e){this.user_id=null,this.private_fields={},this.private_fields.user_fields=[],this.private_fields.properties=[],this.private_fields.tags=[],this.session_fields={},this.session_fields.user_fields=[],this.session_fields.properties=[],this.session_fields.tags=[],this.hs_fields=[],this.device_id=null,this.user_customer_id=e,this.anonymous=!1,this.ip=null,this.tags=[],this.sdk_generated_user_customer_id=!1,this.properties={};var t=(new Date).getTimezoneOffset();this.properties.cf_timezone=-1*t,this.utm_source=null,this.utm_medium=null,this.utm_campaign=null,this.utm_term=null,this.utm_content=null}getCookie(e){const t=`; ${document.cookie}`.split(`; ${e}=`);if(2===t.length)return t.pop().split(";").shift()}withCustomerId(e){return this.user_customer_id=e,this.sdk_generated_user_customer_id=!1,this}makeAnonymous(e){return this.anonymous=e,this}withIp(e){return this.ip=e,this}withPrivateIp(e){return this.private_fields.user_fields.add("ip"),this.withIp(e)}withSessioneIp(e){return this.session_fields.user_fields.add("ip"),this.withIp(e)}withNumberProperty(e,t){if("string"!=typeof e||isNaN(t)||"boolean"==typeof t||t instanceof Date==1||"[object Date]"===Object.prototype.toString.call(t))throw new Error("withNumberProperty: "+e+" value is not a number");return this.properties[e]=t,this}withPrivateNumberProperty(e,t){if("string"!=typeof e||isNaN(t)||"boolean"==typeof t||t instanceof Date==1||"[object Date]"===Object.prototype.toString.call(t))throw new Error("withPrivateNumberProperty: "+e+" value is not a number");return this.properties[e]=t,this.private_fields.properties.push(e),this}withSessionNumberProperty(e,t){if("string"!=typeof e||isNaN(t)||"boolean"==typeof t||t instanceof Date==1||"[object Date]"===Object.prototype.toString.call(t))throw new Error("withSessionNumberProperty: "+e+" value is not a number");return this.properties[e]=t,this.session_fields.properties.push(e),this}withStringProperty(e,t){if("string"!=typeof e||"string"!=typeof t)throw new Error("withStringProperty: "+e+" value is not a string ");return this.properties[e]=t,this}withPrivateStringProperty(e,t){if("string"!=typeof e||"string"!=typeof t)throw new Error("withPrivateStringProperty: "+e+" value is not a string ");return this.properties[e]=t,this.private_fields.properties.push(e),this}withSessionStringProperty(e,t){if("string"!=typeof e||"string"!=typeof t)throw new Error("withSessionStringProperty: "+e+" value is not a string ");return this.properties[e]=t,this.session_fields.properties.push(e),this}withBooleanProperty(e,t){if("string"!=typeof e||"boolean"!=typeof t)throw new Error("withBooleanProperty: "+e+" value is not a Boolean ");return this.properties[e]=t,this}withPrivateBooleanProperty(e,t){if("string"!=typeof e||"boolean"!=typeof t)throw new Error("withPrivateBooleanProperty: "+e+" value is not a Boolean ");return this.properties[e]=t,this.private_fields.properties.push(e),this}withSessionBooleanProperty(e,t){if("string"!=typeof e||"boolean"!=typeof t)throw new Error("withSessionBooleanProperty: "+e+" value is not a Boolean ");return this.properties[e]=t,this.session_fields.properties.push(e),this}withDateProperty(e,t){if("string"!=typeof e||t instanceof Date!=1||"[object Date]"!==Object.prototype.toString.call(t))throw new Error("withDateProperty: "+e+" value is not a Date ");return this.properties[e]=t,this}withPrivateDateProperty(e,t){if("string"!=typeof e||t instanceof Date!=1||"[object Date]"!==Object.prototype.toString.call(t))throw new Error("withPrivateDateProperty: "+e+" value is not a Date ");return this.properties[e]=t,this.private_fields.properties.push(e),this}withSessionDateProperty(e,t){if("string"!=typeof e||t instanceof Date!=1||"[object Date]"!==Object.prototype.toString.call(t))throw new Error("withSessionDateProperty: "+e+" value is not a Date ");return this.properties[e]=t,this.session_fields.properties.push(e),this}withGeoPointProperty(e,t,r){if("string"!=typeof e||isNaN(t)||isNaN(r)||"boolean"==typeof t||"boolean"==typeof r||t instanceof Date==1||"[object Date]"===Object.prototype.toString.call(t)||r instanceof Date==1||"[object Date]"===Object.prototype.toString.call(r))throw new Error("withGeoPointProperty: "+e+" value is not a geo point ");return this.properties[e]={lat:t,lon:r},this}withPrivateGeoPointProperty(e,t,r){if("string"!=typeof e||isNaN(t)||isNaN(r)||"boolean"==typeof t||"boolean"==typeof r||t instanceof Date==1||"[object Date]"===Object.prototype.toString.call(t)||r instanceof Date==1||"[object Date]"===Object.prototype.toString.call(r))throw new Error("withPrivateGeoPointProperty: "+e+" value is not a geo point ");return this.properties[e]={lat:t,lon:r},this.private_fields.properties.push(e),this}withSessionGeoPointProperty(e,t,r){if("string"!=typeof e||isNaN(t)||isNaN(r)||"boolean"==typeof t||"boolean"==typeof r||t instanceof Date==1||"[object Date]"===Object.prototype.toString.call(t)||r instanceof Date==1||"[object Date]"===Object.prototype.toString.call(r))throw new Error("withSessionGeoPointProperty: "+e+" value is not a geo point ");return this.properties[e]={lat:t,lon:r},this.session_fields.properties.push(e),this}withListNumberProperty(e,t){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("string"!=typeof e||isNaN(t[r])||"boolean"==typeof t[r]||t[r]instanceof Date==1||"[object Date]"===Object.prototype.toString.call(t[r]))throw new Error("withListNumberProperty: "+e+" value is not a number");return this.properties[e]=t,this}throw new Error("withListNumberProperty: "+e+" value is not an array")}withPrivateListNumberProperty(e,t){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("string"!=typeof e||isNaN(t[r])||"boolean"==typeof t[r]||t[r]instanceof Date==1||"[object Date]"===Object.prototype.toString.call(t[r]))throw new Error("withPrivateListNumberProperty: "+e+" value is not a number");return this.properties[e]=t,this.private_fields.properties.push(e),this}throw new Error("withPrivateListNumberProperty: "+e+" value is not an array")}withSessionListNumberProperty(e,t){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("string"!=typeof e||isNaN(t[r])||"boolean"==typeof t[r]||t[r]instanceof Date==1||"[object Date]"===Object.prototype.toString.call(t[r]))throw new Error("withSessionListNumberProperty: "+e+" value is not a number");return this.properties[e]=t,this.session_fields.properties.push(e),this}throw new Error("withSessionListNumberProperty: "+e+" value is not an array")}withListStringProperty(e,t){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("string"!=typeof e||"string"!=typeof t[r])throw new Error("withListStringProperty: "+e+" value is not a string");return this.properties[e]=t,this}throw new Error("withListStringProperty: "+e+" value is not an array")}withPrivateListStringProperty(e,t){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("string"!=typeof e||"string"!=typeof t[r])throw new Error("withPrivateListStringProperty: "+e+" value is not a string");return this.properties[e]=t,this.private_fields.properties.push(e),this}throw new Error("withPrivateListStringProperty: "+e+" value is not an array")}withSessionListStringProperty(e,t){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("string"!=typeof e||"string"!=typeof t[r])throw new Error("withSessionListStringProperty: "+e+" value is not a string");return this.properties[e]=t,this.session_fields.properties.push(e),this}throw new Error("withSessionListStringProperty: "+e+" value is not an array")}withListDateProperty(e,t){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("string"!=typeof e||t[r]instanceof Date!=1||"[object Date]"!==Object.prototype.toString.call(t[r]))throw new Error("withListDateProperty: "+e+" value is not a date");return this.properties[e]=t,this}throw new Error("withListDateProperty: "+e+" value is not an array")}withPrivateListDateProperty(e,t){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("string"!=typeof e||t[r]instanceof Date!=1||"[object Date]"!==Object.prototype.toString.call(t[r]))throw new Error("withPrivateListDateProperty: "+e+" value is not a date");return this.properties[e]=t,this.private_fields.properties.push(e),this}throw new Error("withPrivateListDateProperty: "+e+" value is not an array")}withSessionListDateProperty(e,t){if(Array.isArray(t)){for(var r=0;r<t.length;r++)if("string"!=typeof e||t[r]instanceof Date!=1||"[object Date]"!==Object.prototype.toString.call(t[r]))throw new Error("withSessionListDateProperty: "+e+" value is not a date");return this.properties[e]=t,this.session_fields.properties.push(e),this}throw new Error("withSessionListDateProperty: "+e+" value is not an array")}withJsonProperty(e,t){if("string"!=typeof e||!t)throw new Error("withJsonProperty: "+e+" value is not a json ");return this.properties[e]=t,this}withPrivateJsonProperty(e,t){if("string"!=typeof e||!t)throw new Error("withPrivateJsonProperty: "+e+" value is not a json ");return this.properties[e]=t,this.private_fields.properties.push(e),this}withSessionJsonProperty(e,t){if("string"!=typeof e||!t)throw new Error("withSessionJsonProperty: "+e+" value is not a json ");return this.properties[e]=t,this.session_fields.properties.push(e),this}withTags(e){if(Array.isArray(e))return this.tags=e,this}withPrivateTags(e){if(Array.isArray(e))return this.private_fields.tags=e,withTags(e)}withSessionTags(e){if(Array.isArray(e))return this.session_fields.tags=e,withTags(e)}build(){return new d(this)}}}}class f{constructor(e,t){this.cfUserId=null,this.user=e,this.clientKey=t,this.sdkConfigs={},this.configs=null,this.storageKeyPrefix="",this.trackQueueSize=5,this.configSummaryQueueSize=1,this.preview_mode=!1,this.edit_mode=!1,this.personalizedPagePaths={page_paths_contains_list:[],page_paths_exact_match_list:[],page_paths_regex_list:[]},this.pageElementsPathType="ELEMENTS_BY_ID",this.currentPagePersonalized=!0,this.desired_experiences=null,this.preferred_experiences=null,this.last_page_duration=0,this.deviceType="desktop",this.initSettings={},this.preInitTrackMessages=null,this.sessionId="",this.hiddenElementsConfigMap=new Map,this.replacedElementsConfigMap=new Map,this.activeElementLoadObserverConfigMap=new Map,this.registeredToScrollEvents=!1,this.maxScrollDepth=0,this.pageClicks=0,this.periodicTimerId=null,this.lastTrackedPageProperties={scroll_depth:0,current_page_duration:0,scroll_pixel_count:0,click_count:0};var r=new Date;this.current_page_start_time_secs=r.getTime(),this.current_time_secs=0,this.config_summary_history=[],this.session_config_summary_history=[],this.cfid=null,this.templateImpressionMap=new Map,this.timerIds=[],this.regEventHandlers=[],this.spa=!1,this.spa_auto_detect_page_url_change=!1,this.currentPageURL=window.location.href,this.apiTimedOut=!1,this.elementsMoved=!1,this.elementsSwapped=!1}reset(){this.user=null,this.clientKey=null,this.cfUserId=null}getUserId(){return null!=this.user?this.user.user_customer_id:null}setInitSettings(e){this.initSettings=e}getInitSettings(){return this.initSettings}setPreInitTrackMessages(e){this.preInitTrackMessages=e}getPreInitTrackMessages(){return this.preInitTrackMessages}getCurrentPageUrl(){return this.currentPageURL}setCurrentPageURL(e){return this.currentPageURL=e}setElementsSwapped(e){this.elementsSwapped=!!e}setElementsMoved(e){this.elementsMoved=!!e}hasElementsSwpped(){return this.elementsSwapped}hasElementsMoved(){return this.elementsMoved}isSPA(){try{return this.initSettings.spa}catch(e){return!1}}isSPAAutoDetectPageUrlChangeEnabled(){try{return this.initSettings.spa_auto_detect_page_url_change}catch(e){return!1}}setSessionId(e){this.sessionId=e}getSessionId(){return this.sessionId}setPreviewMode(e){this.preview_mode=e}isPreviewMode(){return this.preview_mode}setEditMode(e){this.edit_mode=e}isEditMode(){return this.edit_mode}setStorageKeyPrefix(e){this.storageKeyPrefix=e}setLastPageDuration(){var e=(new Date).getTime(),t=sessionStorage.getItem(this.getStorageKeyPrefix()+"last_page_timestamp_"+this.getUserId());t&&(this.last_page_duration=e-parseInt(t,10)),sessionStorage.setItem(this.getStorageKeyPrefix()+"last_page_timestamp_"+this.getUserId(),e)}pauseCurrentPageTime(){var e=(new Date).getTime();this.current_time_secs=this.current_time_secs+e-this.current_page_start_time_secs,this.current_page_start_time_secs=0,sessionStorage.setItem(this.getStorageKeyPrefix()+"last_page_timestamp_"+this.getUserId(),e-this.current_time_secs)}resumeCurrentPageTime(){var e=new Date;this.current_page_start_time_secs=e.getTime()}getLastPageDuration(){return this.last_page_duration}getConfigSummaryHistory(){return this.config_summary_history}setConfigSummaryHistory(e){this.config_summary_history=e,this.setSessionConfigSummaryHistory()}getSessionConfigSummaryHistory(){return 0==this.session_config_summary_history.length&&this.setSessionConfigSummaryHistory(),this.session_config_summary_history}setSessionConfigSummaryHistory(){var e=new Map;for(var t of this.config_summary_history)e.get(t.experience_id+t.behaviour_id+t.rule_id)||e.set(""+t.experience_id+t.behaviour_id+t.rule_id,{experience_id:t.experience_id,behaviour_id:t.behaviour_id,rule_id:t.rule_id});var r=sessionStorage.getItem("cf_summary_history");if(r&&"{}"!=r){var s=new Map(JSON.parse(r,(function(e,t){return"object"==typeof t&&null!==t&&"Map"===t.dataType?new Map(t.value):t})));for(var i of s.keys())e.get(i)||e.set(i,s.get(i))}var n=this;e.forEach((function(e,t){n.session_config_summary_history.push(e)})),this.session_config_summary_history.length>0&&sessionStorage.setItem("cf_summary_history",JSON.stringify(e,(function(e,t){return t instanceof Map?{dataType:"Map",value:Array.from(t.entries())}:t})))}getCurrentPageDuration(){var e=(new Date).getTime();return this.current_page_start_time_secs>0?this.current_time_secs+e-this.current_page_start_time_secs:this.current_time_secs}setTinyID(e){this.cfid=e}getTinyId(){return this.cfid}isOutboudUser(){var e=!1,t=localStorage.getItem(this.getStorageKeyPrefix()+"_cf_is_outbound_user");if(t){var r=new Date;Math.floor(r/1e3)<parseInt(t)+604800?e=!0:(e=!1,localStorage.removeItem(this.getStorageKeyPrefix()+"_cf_is_outbound_user"))}return e}setLongUrlParams(e){try{if(e&&e.length>0){var t=e.split("?")[1];sessionStorage.setItem(this.getStorageKeyPrefix()+"long_url_params",t);var r=new Date,s=Math.floor(r/1e3);localStorage.setItem(this.getStorageKeyPrefix()+"_cf_is_outbound_user",s)}}catch(e){}}getLongUrlParams(e){return sessionStorage.getItem(this.getStorageKeyPrefix()+"long_url_params")}setDesiredExperiences(e){if(e&&e.length>0)try{"["==e[0]?this.desired_experiences=JSON.parse(e):this.desired_experiences=JSON.parse(atob(e)),sessionStorage.setItem(this.getStorageKeyPrefix()+"desired_experiences_",JSON.stringify(this.desired_experiences))}catch(e){}}getDesiredExperiences(){try{if(this.desired_experiences)return this.desired_experiences;var e=sessionStorage.getItem(this.getStorageKeyPrefix()+"desired_experiences_");if(e)return this.desired_experiences=JSON.parse(e),this.desired_experiences}catch(e){return null}}setPreferredExperiences(e){if(e&&e.length>0)try{"["==e[0]?this.preferred_experiences=JSON.parse(e):this.preferred_experiences=JSON.parse(atob(e)),sessionStorage.setItem(this.getStorageKeyPrefix()+"preferred_experiences_",JSON.stringify(this.preferred_experiences))}catch(e){}}getPreferredExperiences(){try{if(this.preferred_experiences)return this.preferred_experiences;var e=sessionStorage.getItem(this.getStorageKeyPrefix()+"preferred_experiences_");if(e)return this.preferred_experiences=JSON.parse(e),this.preferred_experiences}catch(e){return null}}getStorageKeyPrefix(){return this.storageKeyPrefix}setTrackQueueSize(e){this.trackQueueSize=e}getTrackQueueSize(){return this.trackQueueSize}setConfigSummaryQueueSize(e){this.configSummaryQueueSize=e}getConfigSummaryQueueSize(){return this.configSummaryQueueSize}getDeviceId(){return null!=this.user?this.user.device_id:null}setCFUserId(e){this.cfUserId=e,null!=this.user&&(this.user.user_id=e)}getCFUserId(){return this.cfUserId}setPersonalizedPagePaths(e){this.personalizedPagePaths=e}getPersonalizedPagePaths(){return this.personalizedPagePaths}setUserInfo(e){try{null!=e&&(this.user=e)}catch(e){console.log("CustomFit Exception: ",e)}}setClientKey(e){try{null!=e&&(this.clientKey=e)}catch(e){console.log("CustomFit Exception: ",e)}}setConfigs(e){try{null!=e&&(this.configs=e)}catch(e){console.log("CustomFit Exception: ",e)}}setSdkConfigs(e){try{null!=e&&(this.sdkConfigs=e)}catch(e){console.log("CustomFit Exception: ",e)}}getUser(){try{if(null!=this.user)return this.user}catch(e){console.log("CustomFit Exception: ",e)}return null}getClientKey(){try{return this.clientKey,this.clientKey}catch(e){console.log("CustomFit Exception: ",e)}return null}getConfigs(){try{if(null!=this.configs)return this.configs}catch(e){console.log("CustomFit Exception: ",e)}return null}getSdkConfigs(){try{if(null!=this.sdkConfigs)return this.sdkConfigs}catch(e){console.log("CustomFit Exception: ",e)}return null}getPageElementsPathType(){return this.pageElementsPathType}setPageElementsPathType(e){e&&e.length>0&&(this.pageElementsPathType=e)}isCurrentPagePersonalized(){return this.currentPagePersonalized}setCurrentPagePersonalized(e){this.currentPagePersonalized=!!e}getDeviceType(){return this.deviceType}setDeviceType(e){this.deviceType=e}setHiddenElementsConfigMap(e){this.hiddenElementsConfigMap=e}getHiddenElementsConfigMap(){return this.hiddenElementsConfigMap}getTemplateImpressionMap(){return this.templateImpressionMap}setReplacedElementsConfigMap(e){this.replacedElementsConfigMap=e}getReplacedElementsConfigMap(){return this.replacedElementsConfigMap}setActiveElementLoadObserverConfigMap(e){this.activeElementLoadObserverConfigMap=e}getActiveElementLoadObserverConfigMap(){return this.activeElementLoadObserverConfigMap}setRegisterToScrollEvents(e){this.registeredToScrollEvents=e}getRegisterToScrollEvents(){return this.registeredToScrollEvents}setMaxScrollDepth(e){this.maxScrollDepth=e}getMaxScrollDepth(){return this.maxScrollDepth}setPeriodicTimerId(e){this.periodicTimerId=e}getPeriodicTimerId(){return this.periodicTimerId}getPageClicks(){return this.pageClicks}incrementPageClicks(){this.pageClicks++}getLastTrackedPageProperties(){return this.lastTrackedPageProperties}setLastTrackedPageProperties(e){this.lastTrackedPageProperties=e}getTimerIds(){return this.timerIds}saveTimerId(e){this.timerIds.push(e)}apiTimeoutOccurred(e){this.apiTimedOut=e}hasApiTimedout(){return this.apiTimedOut}clearRunningTimers(){for(var e of this.timerIds)try{clearTimeout(e)}catch(e){console.error(e)}this.timerIds=[];try{this.getPeriodicTimerId()&&(clearInterval(this.getPeriodicTimerId()),this.setPeriodicTimerId(null))}catch(e){console.error(e)}}getRegEventHandlers(){return this.regEventHandlers}saveRegEventHandler(e){this.regEventHandlers.push(e)}unRegEventHandlers(){for(var e of this.regEventHandlers)try{e.obj.removeEventListener?e.obj.removeEventListener(e.event,e.callback,!1):obj.detachEvent&&obj.detachEvent("on"+e.event,e.callback)}catch(e){console.error(e)}this.regEventHandlers=[]}}class m{constructor(e){this.properties=e.eventProperties,this.event_type=e.eventType,this.domain=window.location.hostname,this.event_customer_id=this.domain+"|"+e.eventId,this.name=e.eventId,this.insert_id=p()(),this.event_timestamp=(new Date).toISOString().replace("T"," ").replace('"',"").replace('"',""),this.session_id=null,this.last_page_duration=null,this.config_summary=[]}getEventProperties(){return this.properties}setEventProperties(e){this.properties=e}getEventType(){return this.event_type}getEventId(){return event_customer_id}validateBuild(e){return String(e.constructor)===String(m.Builder)}static get Builder(){return class{constructor(e,t="TRACK"){this.eventId=e,this.eventType="PAGE"===t||"TRACK"===t||"SCREEN"===t||"CLICK"===t||"PAGE_UPDATE"===t||"FORM"===t||"TEMPLATE_VIEW"==t||"TEMPLATE_BUTTON_CLICK"===t?t:"TRACK",this.eventProperties={}}withEventId(e){return this.eventId=e,this}withEventType(e){return"PAGE"===e.toUpperCase()||"TRACK"===e.toUpperCase()||"SCREEN"===e.toUpperCase()||"SCROLL"===e.toUpperCase()||"TEMPLATE_VIEW"===e.toUpperCase()||"TEMPLATE_BUTTON_CLICK"===e.toUpperCase()||"PAGE_UPDATE"===e.toUpperCase()||"FORM"===e.toUpperCase()||"CLICK"===e.toUpperCase()?this.eventType=e.toUpperCase():this.eventType="TRACK",this}withEventTypePage(){return this.eventType="PAGE",this}withEventTypeScreen(){return this.eventType="SCREEN",this}withEventTypeClick(){return this.eventType="CLICK",this}withEventTypeTrack(){return this.eventType="TRACK",this}withEventTypePageUpdate(){return this.eventType="PAGE_UPDATE",this}withEventProperty(e,t){return this.eventProperties[e]=t,this}withEventProperties(e){return this.eventProperties=e,this}build(){return new m(this)}}}}class g{constructor(e,t,r){this.api=t,this.cfRef=e,this.sharedPreferences=r,this.deviceType=this.sharedPreferences.getDeviceType(),this.sessionId=sessionStorage.getItem(this.sharedPreferences.getStorageKeyPrefix()+"session_id_"+this.sharedPreferences.getUserId()),this.events=sessionStorage.getItem(this.sharedPreferences.getStorageKeyPrefix()+"cftrack_events_"+this.sharedPreferences.getUserId()),this.pageview_seq_number=0;var s=sessionStorage.getItem(this.sharedPreferences.getStorageKeyPrefix()+"pageview_seq_number_"+this.sharedPreferences.getUserId());s&&(this.pageview_seq_number=parseInt(s,10)),this.events?(this.events=JSON.parse(this.events),this.events||(this.events=[])):this.events=[];var i=this;try{P(document,"visibilitychange",(function(e){document.hidden?(i.sharedPreferences.pauseCurrentPageTime(),i.sendEvents(!0)):i.sharedPreferences.resumeCurrentPageTime()})),"desktop"==i.deviceType?P(window,"beforeunload",(function(e){i.cfRef.sendPageUpdates(!0),i.sendEvents(!0),i.cfRef.uninit()})):P(window,"unload",(function(e){i.cfRef.sendPageUpdates(!0),i.sendEvents(!0),i.cfRef.uninit()}))}catch(e){console.error(e)}}trackEvent(e,t=!1,r=!1){this.sharedPreferences.isPreviewMode()||null!=e&&null!=e&&(e.session_id=this.sessionId,"PAGE_UPDATE"==e.event_type||"FORM"==e.event_type?e.configs=this.sharedPreferences.getSessionConfigSummaryHistory():delete e.configs,"PAGE"==e.event_type?(e.last_page_duration=this.sharedPreferences.getLastPageDuration(),e.pageview_seq_number=this.pageview_seq_number++,sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"pageview_seq_number_"+this.sharedPreferences.getUserId(),this.pageview_seq_number)):delete e.last_page_duration,e.insert_id||(e.insert_id=p()()),e.event_timestamp||(e.event_timestamp=(new Date).toISOString().replace("T"," ").replace('"',"").replace('"',"")),this.events.push(e),sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cftrack_events_"+this.sharedPreferences.getUserId(),JSON.stringify(this.events)),t?this.sendEvents(r):this.events.length>=this.sharedPreferences.getTrackQueueSize()&&this.sendEvents())}trackEventList(e,t=!1,r=!1){if(!this.sharedPreferences.isPreviewMode()&&e&&0!=e.length){for(var s of e)null!=s&&null!=s&&(s.session_id=this.sessionId,"PAGE"==s.event_type?(s.last_page_duration=this.sharedPreferences.getLastPageDuration(),s.pageview_seq_number=this.pageview_seq_number++,sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"pageview_seq_number_"+this.sharedPreferences.getUserId(),this.pageview_seq_number)):delete s.last_page_duration,s.insert_id||(s.insert_id=p()()),s.event_timestamp||(s.event_timestamp=(new Date).toISOString().replace("T"," ").replace('"',"").replace('"',"")),this.events.push(s));sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cftrack_events_"+this.sharedPreferences.getUserId(),JSON.stringify(this.events)),t?this.sendEvents(r):this.events.length>=this.sharedPreferences.getTrackQueueSize()&&this.sendEvents()}}sendEvents(e=!1){if(!this.sharedPreferences.isPreviewMode()&&this.events.length>0){var t=sessionStorage.getItem(this.sharedPreferences.getStorageKeyPrefix()+"cftrack_events_"+this.sharedPreferences.getUserId());null!=t&&t.length>0&&(t=JSON.parse(t),this.events=[],this.sharedPreferences.getUser().initHubspotUTKIfSet(),this.api.send("POST","/v1/cfe",{user:JSON.parse(JSON.stringify(this.sharedPreferences.getUser(),this.replaceUndefinedOrNull)),events:t,cf_client_sdk_version:cf_latest_sdk_version},e).then((e=>{sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cftrack_events_"+this.sharedPreferences.getUserId(),JSON.stringify(this.events))}),(e=>{for(event in e.request_data.events)this.events.push(event),sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cftrack_events_"+this.sharedPreferences.getUserId(),JSON.stringify(this.events))})).catch((e=>{console.error(e)})))}}}class _{constructor(e,t,r,s){this.config_id=e.config_id,this.version=e.version,this.user_id=e.user_id,this.requested_time=(new Date).toISOString().replace("T"," ").replace('"',"").replace('"',""),this.variation_id=e.variation_id,this.user_customer_id=r,this.user_id=t,this.session_id=s,null!=e.experience_behaviour_response&&(this.behaviour_id=e.experience_behaviour_response.behaviour_id,this.experience_id=e.experience_behaviour_response.experience_id,this.rule_id=e.experience_behaviour_response.rule_id),e.template_info&&(this.is_template_config=!0)}}class v{constructor(e,t){this.api=e,this.sharedPreferences=t,this.summaries=sessionStorage.getItem(this.sharedPreferences.getStorageKeyPrefix()+"cfconfigs_summary_"+this.sharedPreferences.getUserId()),this.sessionId=sessionStorage.getItem(this.sharedPreferences.getStorageKeyPrefix()+"session_id_"+this.sharedPreferences.getUserId()),this.summaries?(this.summaries=JSON.parse(this.summaries),this.summaries||(this.summaries=[])):this.summaries=[];var r=this;try{P(document,"visibilitychange",(function(){document.hidden&&r.sendSummaries(!0)})),P(window,"beforeunload",(function(){r.sendSummaries(!0)}))}catch(e){console.error(e)}}pushSummary(e){this.sharedPreferences.isPreviewMode()||null==e&&null==e||(this.summaries.push(new _(e,this.sharedPreferences.getCFUserId(),this.sharedPreferences.getUserId(),this.sessionId)),sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cfconfigs_summary_"+this.sharedPreferences.getUserId(),JSON.stringify(this.summaries)),this.summaries.length>=this.sharedPreferences.getConfigSummaryQueueSize()&&this.sendSummaries())}_queueSummary(e){this.sharedPreferences.isPreviewMode()||null==e&&null==e||(this.summaries.push(new _(e,this.sharedPreferences.getCFUserId(),this.sharedPreferences.getUserId(),this.sessionId)),sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cfconfigs_summary_"+this.sharedPreferences.getUserId(),JSON.stringify(this.summaries)))}sendSummaries(e=!1){if(!this.sharedPreferences.isPreviewMode()&&(this.sharedPreferences.getUser().initHubspotUTKIfSet(),this.summaries.length>0)){var t=sessionStorage.getItem(this.sharedPreferences.getStorageKeyPrefix()+"cfconfigs_summary_"+this.sharedPreferences.getUserId());null!=t&&t.length>0&&(t=JSON.parse(t),this.sharedPreferences.setConfigSummaryHistory(this.sharedPreferences.getConfigSummaryHistory().concat(this.summaries)),this.summaries=[],this.api.send("POST","/v1/config/request/summary",{user:JSON.parse(JSON.stringify(this.sharedPreferences.getUser(),this.replaceUndefinedOrNull)),summaries:t},e).then((e=>{sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cfconfigs_summary_"+this.sharedPreferences.getUserId(),JSON.stringify(this.summaries))}),(e=>{for(event in e.request_data)this.summaries.push(event),sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cfconfigs_summary_"+this.sharedPreferences.getUserId(),JSON.stringify(this.summaries))})).catch((e=>{console.error(e)})))}}}class y{constructor(e,t){function r(e,t,r,s,i,n){return a(function(e,t){return e<<t|e>>>32-t}(a(a(t,e),a(s,n)),i),r)}function s(e,t,s,i,n,o,a){return r(t&s|~t&i,e,t,n,o,a)}function i(e,t,s,i,n,o,a){return r(t&i|s&~i,e,t,n,o,a)}function n(e,t,s,i,n,o,a){return r(t^s^i,e,t,n,o,a)}function o(e,t,s,i,n,o,a){return r(s^(t|~i),e,t,n,o,a)}function a(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}this.user=null,this.api=null,this.preInitTrackMessages=[],this.actionConfigs=[],this.sendPageTrack=!0,this.personalize=!0,this.sharedPreferences=null,this.MD5=function(e){var t=function(e){for(var t,r="0123456789ABCDEF",s="",i=0;i<e.length;i++)t=e.charCodeAt(i),s+=r.charAt(t>>>4&15)+r.charAt(15&t);return s}(function(e){for(var t="",r=0;r<32*e.length;r+=8)t+=String.fromCharCode(e[r>>5]>>>r%32&255);return t}(function(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var r=1732584193,c=-271733879,l=-1732584194,u=271733878,p=0;p<e.length;p+=16){var h=r,d=c,f=l,m=u;c=o(c=o(c=o(c=o(c=n(c=n(c=n(c=n(c=i(c=i(c=i(c=i(c=s(c=s(c=s(c=s(c,l=s(l,u=s(u,r=s(r,c,l,u,e[p+0],7,-680876936),c,l,e[p+1],12,-389564586),r,c,e[p+2],17,606105819),u,r,e[p+3],22,-1044525330),l=s(l,u=s(u,r=s(r,c,l,u,e[p+4],7,-176418897),c,l,e[p+5],12,1200080426),r,c,e[p+6],17,-1473231341),u,r,e[p+7],22,-45705983),l=s(l,u=s(u,r=s(r,c,l,u,e[p+8],7,1770035416),c,l,e[p+9],12,-1958414417),r,c,e[p+10],17,-42063),u,r,e[p+11],22,-1990404162),l=s(l,u=s(u,r=s(r,c,l,u,e[p+12],7,1804603682),c,l,e[p+13],12,-40341101),r,c,e[p+14],17,-1502002290),u,r,e[p+15],22,1236535329),l=i(l,u=i(u,r=i(r,c,l,u,e[p+1],5,-165796510),c,l,e[p+6],9,-1069501632),r,c,e[p+11],14,643717713),u,r,e[p+0],20,-373897302),l=i(l,u=i(u,r=i(r,c,l,u,e[p+5],5,-701558691),c,l,e[p+10],9,38016083),r,c,e[p+15],14,-660478335),u,r,e[p+4],20,-405537848),l=i(l,u=i(u,r=i(r,c,l,u,e[p+9],5,568446438),c,l,e[p+14],9,-1019803690),r,c,e[p+3],14,-187363961),u,r,e[p+8],20,1163531501),l=i(l,u=i(u,r=i(r,c,l,u,e[p+13],5,-1444681467),c,l,e[p+2],9,-51403784),r,c,e[p+7],14,1735328473),u,r,e[p+12],20,-1926607734),l=n(l,u=n(u,r=n(r,c,l,u,e[p+5],4,-378558),c,l,e[p+8],11,-2022574463),r,c,e[p+11],16,1839030562),u,r,e[p+14],23,-35309556),l=n(l,u=n(u,r=n(r,c,l,u,e[p+1],4,-1530992060),c,l,e[p+4],11,1272893353),r,c,e[p+7],16,-155497632),u,r,e[p+10],23,-1094730640),l=n(l,u=n(u,r=n(r,c,l,u,e[p+13],4,681279174),c,l,e[p+0],11,-358537222),r,c,e[p+3],16,-722521979),u,r,e[p+6],23,76029189),l=n(l,u=n(u,r=n(r,c,l,u,e[p+9],4,-640364487),c,l,e[p+12],11,-421815835),r,c,e[p+15],16,530742520),u,r,e[p+2],23,-995338651),l=o(l,u=o(u,r=o(r,c,l,u,e[p+0],6,-198630844),c,l,e[p+7],10,1126891415),r,c,e[p+14],15,-1416354905),u,r,e[p+5],21,-57434055),l=o(l,u=o(u,r=o(r,c,l,u,e[p+12],6,1700485571),c,l,e[p+3],10,-1894986606),r,c,e[p+10],15,-1051523),u,r,e[p+1],21,-2054922799),l=o(l,u=o(u,r=o(r,c,l,u,e[p+8],6,1873313359),c,l,e[p+15],10,-30611744),r,c,e[p+6],15,-1560198380),u,r,e[p+13],21,1309151649),l=o(l,u=o(u,r=o(r,c,l,u,e[p+4],6,-145523070),c,l,e[p+11],10,-1120210379),r,c,e[p+2],15,718787259),u,r,e[p+9],21,-343485551),r=a(r,h),c=a(c,d),l=a(l,f),u=a(u,m)}return Array(r,c,l,u)}(function(e){for(var t=Array(e.length>>2),r=0;r<t.length;r++)t[r]=0;for(r=0;r<8*e.length;r+=8)t[r>>5]|=(255&e.charCodeAt(r/8))<<r%32;return t}(e),8*e.length)));return t.toLowerCase()}}replaceUndefinedOrNull(e,t){if(null!=t)return t}getUrlParameter(e){try{e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}catch(e){return""}}cleanseUser(e){var t=this.sharedPreferences.getStorageKeyPrefix();this.derivePropertiesFromQueryParams(e),this.deriveUTMParams(e),this.deriveUAParams(e);var r=e.user_customer_id;return r&&""!=r?e.sdk_generated_user_customer_id?e.sdk_generated_user_customer_id=!1:sessionStorage.getItem("customfit_preview")||(e.sdk_generated_user_customer_id=!1,localStorage.setItem(t+"cf_is_customer_id_sdk_generated",e.sdk_generated_user_customer_id),r!==localStorage.getItem(t+"cf_user_customer_id")&&localStorage.removeItem(t+"cf_user_device_id")):(e.sdk_generated_user_customer_id=localStorage.getItem(t+"cf_is_customer_id_sdk_generated"),e.sdk_generated_user_customer_id||(e.sdk_generated_user_customer_id=!1),sessionStorage.getItem("customfit_preview")?(r=sessionStorage.getItem(t+"cf_user_customer_id"),e.sdk_generated_user_customer_id=!1):r=localStorage.getItem(t+"cf_user_customer_id"),r&&""!=r||(r=p()(),localStorage.removeItem(t+"cf_user_device_id"),e.sdk_generated_user_customer_id=!0,localStorage.setItem(t+"cf_is_customer_id_sdk_generated",e.sdk_generated_user_customer_id))),sessionStorage.getItem("customfit_preview")||(e.device_id=localStorage.getItem(t+"cf_user_device_id"),e.device_id||(e.device_id=p()())),e.user_customer_id=r,this.sharedPreferences.setUserInfo(e),sessionStorage.getItem("customfit_preview")?(null==e.properties.is_first_time_visitor&&(sessionStorage.getItem(t+"cf_user_customer_id")?e.properties.is_first_time_visitor=!1:e.properties.is_first_time_visitor=!0),sessionStorage.setItem(t+"cf_user_customer_id",r)):(null==e.properties.is_repeated_visitor&&(localStorage.getItem(t+"cf_user_customer_id")?null==sessionStorage.getItem(t+"cf_is_first_time_visitor")?e.properties.is_first_time_visitor=!1:e.properties.is_first_time_visitor=!0:(e.properties.is_first_time_visitor=!0,sessionStorage.setItem(t+"cf_is_first_time_visitor",r))),localStorage.setItem(t+"cf_user_customer_id",r),cf_subdomains.length),e}initCFUAParser(){var e,t,r,s,i,n,o,a,c,l,u,p,h,d;e="object"==typeof window?window:this,t="model",s="type",i="vendor",o="mobile",a="tablet",c="smarttv",l={extend:function(e,t){var r={};for(var s in e)t[s]&&t[s].length%2==0?r[s]=t[s].concat(e[s]):r[s]=e[s];return r},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},u={rgx:function(e,t){for(var r,s,i,n,o,a,c=0;c<t.length&&!o;){var l=t[c],u=t[c+1];for(r=s=0;r<l.length&&!o;)if(o=l[r++].exec(e))for(i=0;i<u.length;i++)a=o[++s],"object"==typeof(n=u[i])&&n.length>0?2==n.length?"function"==typeof n[1]?this[n[0]]=n[1].call(this,a):this[n[0]]=n[1]:3==n.length?"function"!=typeof n[1]||n[1].exec&&n[1].test?this[n[0]]=a?a.replace(n[1],n[2]):void 0:this[n[0]]=a?n[1].call(this,a,n[2]):void 0:4==n.length&&(this[n[0]]=a?n[3].call(this,a.replace(n[1],n[2])):void 0):this[n]=a||void 0;c+=2}},str:function(e,t){for(var r in t)if("object"==typeof t[r]&&t[r].length>0){for(var s=0;s<t[r].length;s++)if(l.has(t[r][s],e))return"?"===r?void 0:r}else if(l.has(t[r],e))return"?"===r?void 0:r;return e}},p={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},h={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[r="name",n="version"],[/(opios)[\/\s]+([\w\.]+)/i],[[r,"Opera Mini"],n],[/\s(opr)\/([\w\.]+)/i],[[r,"Opera"],n],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[r,n],[/(konqueror)\/([\w\.]+)/i],[[r,"Konqueror"],n],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[r,"IE"],n],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[r,"Edge"],n],[/(yabrowser)\/([\w\.]+)/i],[[r,"Yandex"],n],[/(Avast)\/([\w\.]+)/i],[[r,"Avast Secure Browser"],n],[/(AVG)\/([\w\.]+)/i],[[r,"AVG Secure Browser"],n],[/(puffin)\/([\w\.]+)/i],[[r,"Puffin"],n],[/(focus)\/([\w\.]+)/i],[[r,"Firefox Focus"],n],[/(opt)\/([\w\.]+)/i],[[r,"Opera Touch"],n],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[r,"UCBrowser"],n],[/(comodo_dragon)\/([\w\.]+)/i],[[r,/_/g," "],n],[/(windowswechat qbcore)\/([\w\.]+)/i],[[r,"WeChat(Win) Desktop"],n],[/(micromessenger)\/([\w\.]+)/i],[[r,"WeChat"],n],[/(brave)\/([\w\.]+)/i],[[r,"Brave"],n],[/(qqbrowserlite)\/([\w\.]+)/i],[r,n],[/(QQ)\/([\d\.]+)/i],[r,n],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[r,n],[/(baiduboxapp)[\/\s]?([\w\.]+)/i],[r,n],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[r,n],[/(MetaSr)[\/\s]?([\w\.]+)/i],[r],[/(LBBROWSER)/i],[r],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[n,[r,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[n,[r,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[r,n],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[n,[r,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[r,/(.+)/,"$1 WebView"],n],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[r,/(.+(?:g|us))(.+)/,"$1 $2"],n],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[n,[r,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[r,"Sailfish Browser"],n],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[r,n],[/(dolfin)\/([\w\.]+)/i],[[r,"Dolphin"],n],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[r,"360 Browser"]],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[r,"Chrome"],n],[/(coast)\/([\w\.]+)/i],[[r,"Opera Coast"],n],[/fxios\/([\w\.-]+)/i],[n,[r,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[n,[r,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[n,r],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[r,"GSA"],n],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[r,[n,u.str,p.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[r,n],[/(navigator|netscape)\/([\w\.-]+)/i],[[r,"Netscape"],n],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[r,n]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",l.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",l.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",l.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[t,i,[s,a]],[/applecoremedia\/[\w\.]+ \((ipad)/],[t,[i,"Apple"],[s,a]],[/(apple\s{0,1}tv)/i],[[t,"Apple TV"],[i,"Apple"],[s,c]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[i,t,[s,a]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[t,[i,"Amazon"],[s,a]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[t,u.str,p.device.amazon.model],[i,"Amazon"],[s,o]],[/android.+aft([bms])\sbuild/i],[t,[i,"Amazon"],[s,c]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[t,i,[s,o]],[/\((ip[honed|\s\w*]+);/i],[t,[i,"Apple"],[s,o]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[i,t,[s,o]],[/\(bb10;\s(\w+)/i],[t,[i,"BlackBerry"],[s,o]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[t,[i,"Asus"],[s,a]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[i,"Sony"],[t,"Xperia Tablet"],[s,a]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[t,[i,"Sony"],[s,o]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[i,t,[s,"console"]],[/android.+;\s(shield)\sbuild/i],[t,[i,"Nvidia"],[s,"console"]],[/(playstation\s[34portablevi]+)/i],[t,[i,"Sony"],[s,"console"]],[/(sprint\s(\w+))/i],[[i,u.str,p.device.sprint.vendor],[t,u.str,p.device.sprint.model],[s,o]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[i,[t,/_/g," "],[s,o]],[/(nexus\s9)/i],[t,[i,"HTC"],[s,a]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p|vog-l29|ane-lx1|eml-l29|ele-l29)/i],[t,[i,"Huawei"],[s,o]],[/android.+(bah2?-a?[lw]\d{2})/i],[t,[i,"Huawei"],[s,a]],[/(microsoft);\s(lumia[\s\w]+)/i],[i,t,[s,o]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[t,[i,"Microsoft"],[s,"console"]],[/(kin\.[onetw]{3})/i],[[t,/\./g," "],[i,"Microsoft"],[s,o]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[t,[i,"Motorola"],[s,o]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[t,[i,"Motorola"],[s,a]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[i,l.trim],[t,l.trim],[s,c]],[/hbbtv.+maple;(\d+)/i],[[t,/^/,"SmartTV"],[i,"Samsung"],[s,c]],[/\(dtv[\);].+(aquos)/i],[t,[i,"Sharp"],[s,c]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[i,"Samsung"],t,[s,a]],[/smart-tv.+(samsung)/i],[i,[s,c],t],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[i,"Samsung"],t,[s,o]],[/sie-(\w*)/i],[t,[i,"Siemens"],[s,o]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[i,"Nokia"],t,[s,o]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[t,[i,"Acer"],[s,a]],[/android.+([vl]k\-?\d{3})\s+build/i],[t,[i,"LG"],[s,a]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[i,"LG"],t,[s,a]],[/(lg) netcast\.tv/i],[i,t,[s,c]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[t,[i,"LG"],[s,o]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[i,t,[s,a]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[t,[i,"Lenovo"],[s,a]],[/(lenovo)[_\s-]?([\w-]+)/i],[i,t,[s,o]],[/linux;.+((jolla));/i],[i,t,[s,o]],[/((pebble))app\/[\d\.]+\s/i],[i,t,[s,"wearable"]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[i,t,[s,o]],[/crkey/i],[[t,"Chromecast"],[i,"Google"],[s,c]],[/android.+;\s(glass)\s\d/i],[t,[i,"Google"],[s,"wearable"]],[/android.+;\s(pixel c)[\s)]/i],[t,[i,"Google"],[s,a]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[t,[i,"Google"],[s,o]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[t,/_/g," "],[i,"Xiaomi"],[s,o]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[t,/_/g," "],[i,"Xiaomi"],[s,a]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[t,[i,"Meizu"],[s,o]],[/(mz)-([\w-]{2,})/i],[[i,"Meizu"],t,[s,o]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[t,[i,"OnePlus"],[s,o]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[t,[i,"RCA"],[s,a]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[t,[i,"Dell"],[s,a]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[t,[i,"Verizon"],[s,a]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[i,"Barnes & Noble"],t,[s,a]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[t,[i,"NuVision"],[s,a]],[/android.+;\s(k88)\sbuild/i],[t,[i,"ZTE"],[s,a]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[t,[i,"Swiss"],[s,o]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[t,[i,"Swiss"],[s,a]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[t,[i,"Zeki"],[s,a]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[i,"Dragon Touch"],t,[s,a]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[t,[i,"Insignia"],[s,a]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[t,[i,"NextBook"],[s,a]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[i,"Voice"],t,[s,o]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[i,"LvTel"],t,[s,o]],[/android.+;\s(PH-1)\s/i],[t,[i,"Essential"],[s,o]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[t,[i,"Envizen"],[s,a]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[i,t,[s,a]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[t,[i,"MachSpeed"],[s,a]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[i,t,[s,a]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[t,[i,"Rotor"],[s,a]],[/android.+(KS(.+))\s+build/i],[t,[i,"Amazon"],[s,a]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[i,t,[s,a]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[s,l.lowerize],i,t],[/[\s\/\(](smart-?tv)[;\)]/i],[[s,c]],[/(android[\w\.\s\-]{0,9});.+build/i],[t,[i,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[n,[r,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[n,[r,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[r,n],[/rv\:([\w\.]{1,9}).+(gecko)/i],[n,r]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[r,n],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[r,[n,u.str,p.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[r,"Windows"],[n,u.str,p.os.windows.version]],[/\((bb)(10);/i],[[r,"BlackBerry"],n],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[r,n],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[r,"Symbian"],n],[/\((series40);/i],[r],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[r,"Firefox OS"],n],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[r,n],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[r,"Chromium OS"],n],[/(sunos)\s?([\w\.\d]*)/i],[[r,"Solaris"],n],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[r,n],[/(haiku)\s(\w+)/i],[r,n],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[n,/_/g,"."],[r,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[r,"Mac OS"],[n,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[r,n]]},d=function(t,r){if("object"==typeof t&&(r=t,t=void 0),!(this instanceof d))return new d(t,r).getResult();var s=t||(e&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent:""),i=r?l.extend(h,r):h;return this.getBrowser=function(){var e={name:void 0,version:void 0};return u.rgx.call(e,s,i.browser),e.major=l.major(e.version),e},this.getCPU=function(){var e={architecture:void 0};return u.rgx.call(e,s,i.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return u.rgx.call(e,s,i.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return u.rgx.call(e,s,i.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return u.rgx.call(e,s,i.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return s},this.setUA=function(e){return s=e,this},this},d.VERSION="0.7.21",d.BROWSER={NAME:r,MAJOR:"major",VERSION:n},d.CPU={ARCHITECTURE:"architecture"},d.DEVICE={MODEL:t,VENDOR:i,TYPE:s,CONSOLE:"console",MOBILE:o,SMARTTV:c,TABLET:a,WEARABLE:"wearable",EMBEDDED:"embedded"},d.ENGINE={NAME:r,VERSION:n},d.OS={NAME:r,VERSION:n},this.CFUAParser=d}deriveUAParams(e){try{if(!this.captureDeviceInfo)return;var t=this.sharedPreferences.getStorageKeyPrefix(),r={},s=sessionStorage.getItem(t+"ua_"+e.user_customer_id);if(s&&s.length>0?r=JSON.parse(s):(this.initCFUAParser(),r=(new this.CFUAParser).getResult(),sessionStorage.setItem(t+"ua_"+e.user_customer_id,JSON.stringify(r))),r.browser){r.browser.name&&r.browser.name.length>0&&(e.properties.cf_browser_name=r.browser.name),r.browser.version&&r.browser.version.length>0&&(e.properties.cf_browser_version=r.browser.version);var i=navigator.languages;i&&i.length>0&&(e.properties.cf_browser_preferred_languages=i);var n=navigator.language||navigator.userLanguage;n&&n.length>0&&(e.properties.cf_browser_primary_language=n)}r.os&&(r.os.name&&r.os.name.length>0&&(e.properties.cf_os_name=r.os.name),r.os.version&&r.os.version.length>0&&(e.properties.cf_os_version=r.os.version)),r.device&&(r.device.model&&r.device.model.length>0&&(e.properties.cf_device_model=r.device.model),r.device.type&&r.device.type.length>0&&(e.properties.cf_device_type=r.device.type),r.device.vendor&&r.device.vendor.length>0&&(e.properties.cf_device_vendor=r.device.vendor)),e.properties.cf_device_type&&""!=e.properties.cf_device_type||(e.properties.cf_device_type="desktop"),this.sharedPreferences.setDeviceType(e.properties.cf_device_type),r.cpu&&r.cpu.architecture&&r.cpu.architecture.length>0&&(e.properties.cf_cpu_architecture=r.cpu.architecture),r.ua&&r.ua.length>0&&(e.properties.cf_ua=r.ua),screen.height&&(e.properties.cf_screen_height=screen.height),screen.width&&(e.properties.cf_screen_width=screen.width);var o=sessionStorage.getItem(t+"referrer_"+e.user_customer_id);if(o){e.properties.referrer_url=o;const t=new URL(o);e.properties.referrer=t.host}else if((o=document.referrer)&&""!=o&&0!==o.indexOf(location.protocol+"//"+location.host)){sessionStorage.setItem(t+"referrer_"+e.user_customer_id,o),e.properties.referrer_url=o;const r=new URL(o);e.properties.referrer=r.host}else e.properties.referrer="",e.properties.referrer_url=""}catch(e){console.log(e)}}deriveUTMParams(e){var t=this.sharedPreferences.getStorageKeyPrefix();try{!e.utm_source&&this.getUrlParameter("utm_source")?(e.properties.utm_source=this.getUrlParameter("utm_source"),sessionStorage.setItem(t+"utm_source_"+e.user_customer_id,e.properties.utm_source),e.properties.session_utm_source=e.properties.utm_source,e.session_fields.properties.push("session_utm_source")):sessionStorage.getItem(t+"utm_source_"+e.user_customer_id)?(e.properties.utm_source=sessionStorage.getItem(t+"utm_source_"+e.user_customer_id),e.properties.session_utm_source=e.properties.utm_source,e.session_fields.properties.push("session_utm_source")):e.utm_source&&sessionStorage.setItem(t+"utm_source_"+e.user_customer_id,e.properties.utm_source),!e.utm_campaign&&this.getUrlParameter("utm_campaign")?(e.properties.utm_campaign=this.getUrlParameter("utm_campaign"),sessionStorage.setItem(t+"utm_campaign_"+e.user_customer_id,e.properties.utm_campaign),e.properties.session_utm_campaign=e.properties.utm_campaign,e.session_fields.properties.push("session_utm_campaign")):sessionStorage.getItem(t+"utm_campaign_"+e.user_customer_id)?(e.properties.utm_campaign=sessionStorage.getItem(t+"utm_campaign_"+e.user_customer_id),e.properties.session_utm_campaign=e.properties.utm_campaign,e.session_fields.properties.push("session_utm_campaign")):e.utm_campaign&&sessionStorage.setItem(t+"utm_campaign_"+e.user_customer_id,e.properties.utm_campaign),!e.utm_term&&this.getUrlParameter("utm_term")?(e.properties.utm_term=this.getUrlParameter("utm_term"),sessionStorage.setItem(t+"utm_term_"+e.user_customer_id,e.properties.utm_term),e.properties.session_utm_term=e.properties.utm_term,e.session_fields.properties.push("session_utm_term")):!e.utm_term&&sessionStorage.getItem(t+"utm_term_"+e.user_customer_id)?(e.properties.utm_term=sessionStorage.getItem(t+"utm_term_"+e.user_customer_id),e.properties.session_utm_term=e.properties.utm_term,e.session_fields.properties.push("session_utm_term")):e.utm_term&&sessionStorage.setItem(t+"utm_term_"+e.user_customer_id,e.properties.utm_term),!e.utm_content&&this.getUrlParameter("utm_content")?(e.properties.utm_content=this.getUrlParameter("utm_content"),sessionStorage.setItem(t+"utm_content_"+e.user_customer_id,e.properties.utm_content),e.properties.session_utm_content=e.properties.utm_content,e.session_fields.properties.push("session_utm_content")):!e.utm_content&&sessionStorage.getItem(t+"utm_content_"+e.user_customer_id)?(e.properties.utm_content=sessionStorage.getItem(t+"utm_content_"+e.user_customer_id),e.properties.session_utm_content=e.properties.utm_content,e.session_fields.properties.push("session_utm_content")):e.utm_content&&sessionStorage.setItem(t+"utm_content_"+e.user_customer_id,e.properties.utm_medium),!e.utm_medium&&this.getUrlParameter("utm_medium")?(e.properties.utm_medium=this.getUrlParameter("utm_medium"),sessionStorage.setItem(t+"utm_medium_"+e.user_customer_id,e.properties.utm_medium),e.properties.session_utm_medium=e.properties.utm_medium,e.session_fields.properties.push("session_utm_medium")):!e.utm_medium&&sessionStorage.getItem(t+"utm_medium_"+e.user_customer_id)?(e.properties.utm_medium=sessionStorage.getItem(t+"utm_medium_"+e.user_customer_id),e.properties.session_utm_medium=e.properties.utm_medium,e.session_fields.properties.push("session_utm_medium")):e.utm_medium&&sessionStorage.setItem(t+"utm_medium_"+e.user_customer_id,e.properties.utm_medium)}catch(e){console.log(e)}}derivePropertiesFromQueryParams(e){var t=this.sharedPreferences.getStorageKeyPrefix(),r=[],s=[],i=[],n=[],o=[],a=this.sharedPreferences.getLongUrlParams(),c=location.search;null!=c&&c.length>0&&a&&a.length>0?c=c+"&"+a:null!=c&&0==c.length&&a&&a.length>0&&(c="?"+a);try{const a=new URLSearchParams(c),P=new URLSearchParams(c);var l=!1;for(let t of P)if(t[0]&&t[0].startsWith("cfup_"))"user_customer_id"===(u=t[0].substr(5))?(e.user_customer_id=t[1],a.delete(t[0]),l=!0):u&&u.length>0&&t[1]&&t[1].length>0&&(e.properties[u]=t[1],a.delete(t[0]),l=!0);else if(t[0]&&t[0].startsWith("cfupp_"))(u=t[0].substr(6))&&u.length>0&&t[1]&&t[1].length>0&&(e.properties[u]=t[1],-1===e.private_fields.properties.indexOf(u)&&(s.push({key:u,value:t[1]}),e.private_fields.properties.push(u)),a.delete(t[0]),l=!0);else if(t[0]&&t[0].startsWith("cfuhp_"))(u=t[0].substr(6))&&u.length>0&&t[1]&&t[1].length>0&&(e.properties[u]=t[1],-1===e.hs_fields.indexOf(u)&&(i.push({key:u,value:t[1]}),e.hs_fields.push(u)),a.delete(t[0]),l=!0);else if(t[0]&&t[0].startsWith("cfusp_")){var u;(u=t[0].substr(6))&&u.length>0&&t[1]&&t[1].length>0&&(e.properties[u]=t[1],-1===e.session_fields.properties.indexOf(u)&&(r.push({key:u,value:t[1]}),e.session_fields.properties.push(u)),a.delete(t[0]),l=!0)}else t[0]&&"cfut"==t[0]?t[1]&&t[1].length>0&&(e.tags=t[1].split(","),a.delete(t[0]),l=!0):t[0]&&"cfupt"==t[0]?t[1]&&t[1].length>0&&(e.private_fields.tags=t[1].split(","),o=e.private_fields.tags,a.delete(t[0]),l=!0):t[0]&&"cfust"==t[0]?t[1]&&t[1].length>0&&(e.session_fields.tags=t[1].split(","),n=e.session_fields.tags,a.delete(t[0]),l=!0):t[0]&&"customfit_desired_experiences"===t[0]?(this.sharedPreferences.setDesiredExperiences(t[1]),a.delete(t[0]),l=!0):t[0]&&"customfit_preferred_experiences"===t[0]?(this.sharedPreferences.setPreferredExperiences(t[1]),a.delete(t[0]),l=!0):t[0]&&"cfid"===t[0]?(this.sharedPreferences.setTinyID(t[1]),a.delete(t[0]),l=!0):t[0]&&"cfsid"===t[0]?this.sharedPreferences.setTinyID(t[1]):t[0]&&"email"===t[0]&&(e.properties[t[0]]=t[1],l=!0);if(l)try{a.toString().length>0?window.history.replaceState({},document.title,window.location.pathname+"?"+a.toString()):window.history.replaceState({},document.title,window.location.pathname),this.sharedPreferences.setCurrentPageURL(window.location.href.split("?"))}catch(e){}var p=sessionStorage.getItem(t+"private_fields_");if(p)for(var h of JSON.parse(p))-1===e.private_fields.properties.indexOf(h.key)&&(e.properties[h.key]=h.value,e.private_fields.properties.push(h.key),s.push(h));s.length>0&&sessionStorage.setItem(t+"private_fields_",JSON.stringify(s));var d=sessionStorage.getItem(t+"private_tags_");if(d)for(var f of JSON.parse(d))e.private_fields.tags.push(f);o.length>0&&sessionStorage.setItem(t+"private_tags_",JSON.stringify(o));var m=sessionStorage.getItem(t+"hs_fields_");if(m)for(var g of JSON.parse(m))e.properties[g.key]=g.value,e.hs_fields.push(g.key),i.push(g);i.length>0&&sessionStorage.setItem(t+"hs_fields_",JSON.stringify(i));var _=sessionStorage.getItem(t+"session_fields_");if(_)for(var v of JSON.parse(_))-1===e.session_fields.properties.indexOf(v.key)&&(e.properties[v.key]=v.value,e.session_fields.properties.push(v.key),r.push(v));r.length>0&&sessionStorage.setItem(t+"session_fields_",JSON.stringify(r));var y=sessionStorage.getItem(t+"session_tags_");if(y)for(var w of JSON.parse(y))e.session_fields.tags.push(w);n.length>0&&sessionStorage.setItem(t+"session_tags_",JSON.stringify(n)),e.properties.cf_current_page_url=window.location.href,e.session_fields.properties.push("cf_current_page_url")}catch(e){console.log(e)}}getCurrentPageScrollPercentage(){try{var e=document.documentElement,t=document.body,r="scrollTop",s="scrollHeight",i=e[r]||t[r],n=(e[s]||t[s])-e.clientHeight;return 0==n?0:i/n*100}catch(e){return 0}}getUser(){try{return this.sharedPreferences.getUser()}catch(e){return null}}updateUser(e,t=!1){return new Promise(((r,s)=>{try{if(this.getUrlParameter("utm_customfit_edit"))return void s();if(this.getUrlParameter("customfit_preview")||sessionStorage.getItem("customfit_preview"))return void s();if(e&&(this.user=this.cleanseUser(e),this.sharedPreferences.setUserInfo(this.user)),1==cf_is_outbound&&0==cf_is_inbound&&!this.sharedPreferences.getLongUrlParams()&&!this.sharedPreferences.getTinyId()&&!this.sharedPreferences.isOutboudUser())return console.log("CustomFit.ai is enabled for only outbound campaigns. Reach out to support(reach@customfit.ai) for upgradation"),void s();this.sharedPreferences.getUser().initHubspotUTKIfSet();var i="";this.maintainSession||(i=window.location.pathname.length>1?window.location.pathname.replace(/\/$/,""):window.location.pathname),this.api.send("POST","/v1/users/configs",{user:JSON.parse(JSON.stringify(this.user,this.replaceUndefinedOrNull)),desired_experiences:this.sharedPreferences.getDesiredExperiences(),preferred_experiences:this.sharedPreferences.getPreferredExperiences(),cfid:this.sharedPreferences.getTinyId(),preview_mode:this.sharedPreferences.isPreviewMode(),current_page_path:i,session_id:this.user.latest_session_id},t).then((e=>{r()}),(e=>{console.log("CustomFit.ai Error status:"+e.status),console.log("CustomFit.ai Error message:"+e.message),console.log("CustomFit.ai Error data:"+JSON.stringify(e.data)),r()})).catch((e=>{r()}))}catch(e){console.log(e),r()}}))}getExperienceConfigs(e,t,r){return new Promise(((t,s)=>{try{if(this.getUrlParameter("utm_customfit_edit"))return void s();if(this.getUrlParameter("customfit_preview")||sessionStorage.getItem("customfit_preview"))return void s();if(r&&(this.user=this.cleanseUser(r),this.sharedPreferences.setUserInfo(this.user)),1==cf_is_outbound&&0==cf_is_inbound&&!this.sharedPreferences.getLongUrlParams()&&!this.sharedPreferences.getTinyId()&&!this.sharedPreferences.isOutboudUser())return console.log("CustomFit.ai is enabled for only outbound campaigns. Reach out to support(reach@customfit.ai) for upgradation"),void s();this.sharedPreferences.getUser().initHubspotUTKIfSet();var i="";this.maintainSession||(i=window.location.pathname.length>1?window.location.pathname.replace(/\/$/,""):window.location.pathname),this.api.send("POST","/v1/users/configs",{user:JSON.parse(JSON.stringify(this.user,this.replaceUndefinedOrNull)),desired_experiences:this.sharedPreferences.getDesiredExperiences(),preferred_experiences:e,cfid:this.sharedPreferences.getTinyId(),preview_mode:this.sharedPreferences.isPreviewMode(),current_page_path:i,session_id:this.user.latest_session_id},!1).then((r=>{if(r){var s={};if(r.configs)for(var i in r.configs)if(r.configs.hasOwnProperty(i)&&r.configs[i].experience_behaviour_response&&r.configs[i].experience_behaviour_response.experience_id)if(e&&e.length>0){var n=!1;for(var o of e)if(o==r.configs[i].experience_behaviour_response.experience_id){n=!0;break}n&&(s[i]=r.configs[i])}else s[i]=r.configs[i];t(s)}else t()}),(e=>{console.log("CustomFit.ai Error status:"+e.status),console.log("CustomFit.ai Error message:"+e.message),console.log("CustomFit.ai Error data:"+JSON.stringify(e.data)),s()})).catch((e=>{s()}))}catch(e){console.log(e),s()}}))}refreshConfigs(e){return new Promise(((t,r)=>{try{if(this.getUrlParameter("utm_customfit_edit"))return console.log("CustomFit.ai is running in edit mode"),void r();if((this.getUrlParameter("customfit_preview")||sessionStorage.getItem("customfit_preview"))&&(sessionStorage.setItem("customfit_preview",!0),this.sharedPreferences.setPreviewMode(!0)),e&&(this.user=this.cleanseUser(e),this.sharedPreferences.setUserInfo(this.user)),1==cf_is_outbound&&0==cf_is_inbound&&!this.sharedPreferences.getLongUrlParams()&&!this.sharedPreferences.getTinyId()&&!this.sharedPreferences.isOutboudUser())return console.log("CustomFit.ai is enabled for only outbound campaigns. Reach out to support(reach@customfit.ai) for upgradation"),void r();var s="";this.maintainSession||(s=window.location.pathname.length>1?window.location.pathname.replace(/\/$/,""):window.location.pathname),this.api.send("POST","/v1/users/configs",{user:JSON.parse(JSON.stringify(this.user,this.replaceUndefinedOrNull)),desired_experiences:this.sharedPreferences.getDesiredExperiences(),preferred_experiences:this.sharedPreferences.getPreferredExperiences(),cfid:this.sharedPreferences.getTinyId(),preview_mode:this.sharedPreferences.isPreviewMode(),current_page_path:s,session_id:this.user.latest_session_id}).then((e=>{this.sharedPreferences.setConfigs(e.configs),this.sharedPreferences.setLongUrlParams(e.long_url),this.sharedPreferences.setCFUserId(e.user_id),this.extractCurrentPagePathInformation(e),sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cfconfigs_"+this.user.user_customer_id,JSON.stringify(e)),this.sharedPreferences.isCurrentPagePersonalized()&&this.updatePageElements(e.configs,!1),t()}),(e=>{console.log("CustomFit.ai Error status:"+e.status),console.log("CustomFit.ai Error message:"+e.message),console.log("CustomFit.ai Error data:"+JSON.stringify(e.data)),t()})).catch((e=>{t()}))}catch(e){console.log(e),t()}}))}construct(e,t,r=!1,s=!0,i=5,n=!1,o=!0){var a=!1;this.captureDeviceInfo=!0,this.spa=!1,this.spa_auto_detect_page_url_change=!1,"boolean"!=typeof r?(r.personalize&&(a=r.personalize),null!=r.maintainSession&&(s=r.maintainSession),r.trackQueueSize&&(i=r.trackQueueSize),r.sendPageTrack&&(n=r.sendPageTrack),r.makeDocumentVisibleAfterUpdate&&(o=r.makeDocumentVisibleAfterUpdate),r.captureDeviceInfo&&(this.captureDeviceInfo=r.captureDeviceInfo),r.spa&&(this.spa=r.spa),r.spa_auto_detect_page_url_change&&(this.spa_auto_detect_page_url_change=r.spa_auto_detect_page_url_change)):a=r,i<5&&(i=5);try{this.sharedPreferences=new f(this.user,t),w=this.sharedPreferences,this.getUrlParameter("customfit_preview")&&(cf_intelligent_code_enabled=!1),this.displayToggle();var c=!1;(this.getUrlParameter("customfit_preview")||sessionStorage.getItem("customfit_preview"))&&(console.log("CustomFit.ai is running in preview mode"),sessionStorage.setItem("customfit_preview",!0),cf_intelligent_code_enabled=!1,c=!0);var l="cf_"+this.MD5(t)+"_";if(this.sharedPreferences.setStorageKeyPrefix(l),this.sharedPreferences.setTrackQueueSize(i),this.sharedPreferences.setInitSettings({personalize:a,maintainSession:s,trackQueueSize:i,sendPageTrack:n,makeDocumentVisibleAfterUpdate:o,captureDeviceInfo:this.captureDeviceInfo,spa:this.spa,spa_auto_detect_page_url_change:this.spa_auto_detect_page_url_change}),this.user=this.cleanseUser(e),!c&&1==cf_is_outbound&&0==cf_is_inbound&&0==cf_personalized_users_limit_exceeded&&!this.sharedPreferences.getTinyId()&&!this.sharedPreferences.isOutboudUser())return console.log("CustomFit.ai is enabled for only outbound campaigns. Reach out to support (reach@customfit.ai) for upgradation"),this.makeDocumentVisible(!0,!0),!1;if(this.isReferrerBlackListed(this.user.properties.referrer))return this.makeDocumentVisible(!0,!0),!1;if(this.sharedPreferences.setUserInfo(this.user),this.sharedPreferences.setLastPageDuration(),this.getUrlParameter("utm_customfit_edit"))return console.log("CustomFit.ai is running in edit mode"),this.sharedPreferences.setEditMode(!0),this.makeDocumentVisible(!0,!0),!1;(this.getUrlParameter("customfit_preview")||sessionStorage.getItem("customfit_preview"))&&(e=(new d.Builder).build(),this.user=this.cleanseUser(e),this.sharedPreferences.setUserInfo(this.user),this.sharedPreferences.setPreviewMode(!0));var u=sessionStorage.getItem(this.sharedPreferences.getStorageKeyPrefix()+"session_id_"+this.sharedPreferences.getUserId());u||(u=p()(),sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"session_id_"+this.sharedPreferences.getUserId(),u)),this.sharedPreferences.setSessionId(u),this.user.properties.latest_session_id=u,this.sharedPreferences.setUserInfo(this.user)}catch(e){console.error(e)}return!0}displayToggle(){var e=document.querySelector("html");if(cf_intelligent_code_enabled&&cf_page_paths){if(this.isCurrentPagePersonalized(cf_page_paths)&&(this.hideElementsIfNeeded(),this.sharedPreferences.getHiddenElementsConfigMap().size>0)){var t=this,r=setTimeout((function(){t.removeAllHideStyles(),t.sharedPreferences.apiTimeoutOccurred(!0)}),cf_sdk_timeout_in_seconds);this.sharedPreferences.saveTimerId(r)}}else e.classList?e.classList.add("customfit-invisible-block"):e.className&&(e.className=e.className+" customfit-invisible-block"),t=this,r=setTimeout((function(){t.makeDocumentVisible(!0,!0);for(var e=document.querySelectorAll(".customfit-invisible-block"),r=0;e&&r<e.length;r++)try{e[r].style.transition=".1s all",e[r].className=e[r].className.replace(/\bcustomfit-invisible-block\b/g,"")}catch(e){}t.sharedPreferences.apiTimeoutOccurred(!0)}),cf_sdk_timeout_in_seconds),this.sharedPreferences.saveTimerId(r);e.className=e.className.replace(/\bcustomfit-invisible-preinit-block\b/g,"");var s=document.getElementById("customfit-invisible-preinit-css-block");s&&s.parentNode.removeChild(s)}uninit(){try{this.sharedPreferences&&1==this.sharedPreferences.isSPA()&&(this.sharedPreferences.clearRunningTimers(),this.sharedPreferences.unRegEventHandlers(),this.sharedPreferences.unInited=!0)}catch(e){console.error(e)}}init(e,t,r=!1,s=!0,i=5,n=!1,o=!0){return cf_legacy&&this.construct(e,t,r,s,i,n,o),window.customFit&&window.customFit.e&&window.customFit.e.length>0&&(this.preInitTrackMessages=window.customFit.e,window.customFit.e=[]),new Promise(((e,t)=>{try{if(this.getUrlParameter("utm_customfit_edit"))return console.log("CustomFit.ai is running in edit mode"),void t();this.api=new h(this.sharedPreferences.getClientKey()),this.maintainSession=this.sharedPreferences.getInitSettings().maintainSession,this.personalize=this.sharedPreferences.getInitSettings().personalize,this.eventTracker=new g(this,this.api,this.sharedPreferences),this.summaryExporter=new v(this.api,this.sharedPreferences),this.sendPageTrack=this.sharedPreferences.getInitSettings().sendPageTrack,this.spa=this.sharedPreferences.getInitSettings().spa,this.spa_auto_detect_page_url_change=this.sharedPreferences.getInitSettings().spa_auto_detect_page_url_change;let i=sessionStorage.getItem(this.sharedPreferences.getStorageKeyPrefix()+"cfconfigs_"+this.sharedPreferences.getUserId());if(i){var r=JSON.parse(i);if(this.sharedPreferences.setConfigs(r.configs),this.sharedPreferences.setLongUrlParams(r.long_url),this.sharedPreferences.setCFUserId(r.user_id),this.extractCurrentPagePathInformation(r),this.maintainSession)return this.updatePageElements(r.configs,!0,this.sendPageTrack,this.personalize),this.makeDocumentVisible(this.personalize),void e();this.sharedPreferences.isCurrentPagePersonalized()&&(i=null)}if(!i&&this.personalize){var s="";this.maintainSession||(s=window.location.pathname.length>1?window.location.pathname.replace(/\/$/,""):window.location.pathname),cf_script_time_before_config_call=(new Date).getTime(),this.api.send("POST","/v1/users/configs",{user:JSON.parse(JSON.stringify(this.user,this.replaceUndefinedOrNull)),desired_experiences:this.sharedPreferences.getDesiredExperiences(),preferred_experiences:this.sharedPreferences.getPreferredExperiences(),cfid:this.sharedPreferences.getTinyId(),current_page_path:s,preview_mode:this.sharedPreferences.isPreviewMode(),session_id:this.sharedPreferences.getSessionId()}).then((t=>{cf_script_time_after_config_call=(new Date).getTime(),this.sharedPreferences.setConfigs(t.configs),this.sharedPreferences.setLongUrlParams(t.long_url),this.sharedPreferences.setCFUserId(t.user_id),this.extractCurrentPagePathInformation(t),sessionStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cfconfigs_"+this.sharedPreferences.getUserId(),JSON.stringify(t)),this.sharedPreferences.hasApiTimedout()&&!cf_personalize_post_sdk_timeout||!this.sharedPreferences.isCurrentPagePersonalized()?(this.makeDocumentVisible(this.personalize,!0),this.sendCurrentPageEvents()):(this.updatePageElements(t.configs,!0,this.sendPageTrack,this.personalize),this.makeDocumentVisible(this.personalize)),e(),this.initCBHandlers()}),(t=>{console.log("CustomFit.ai Error status:"+t.status),console.log("CustomFit.ai Error message:"+t.message),console.log("CustomFit.ai Error data:"+JSON.stringify(t.data)),this.makeDocumentVisible(this.personalize,!0),e()})).catch((t=>{this.makeDocumentVisible(this.personalize,!0),e()}))}else{try{this.makeDocumentVisible(this.personalize,!0),this.sendCurrentPageEvents(),this.initCBHandlers()}catch(e){console.log("CustomFit.ai, error:",e)}e()}}catch(t){console.log(t),this.makeDocumentVisible(this.personalize,!0),e()}}))}initCBHandlers(){var e=this;P(window,"click",(function(){e.sharedPreferences.incrementPageClicks()})),"loading"!=document.readyState?e.registerOnDocumentLoadHandlers(e):P(document,"DOMContentLoaded",(function(t){e.registerOnDocumentLoadHandlers(e)}),!1),P(window,"scroll",(function(t){var r=e.getCurrentPageScrollPercentage();(r=parseFloat(r.toFixed(3)))>e.sharedPreferences.getMaxScrollDepth()&&e.sharedPreferences.setMaxScrollDepth(r)})),cf_is_hubspot_enabled&&(e.registerHubspotFormEvents(e),setTimeout((function(){if(!e.sharedPreferences.getUser().isHubspotUTKExtracted())try{e.sharedPreferences.getUser().initHubspotUTKIfSet()&&e.sharedPreferences.getUser().isHubspotUTKExtracted()&&(e.sharedPreferences.getUser().form_update_detected="true",e.updateUser())}catch(e){console.error(e)}}),3e3)),1==e.sharedPreferences.isSPA()&&e.sharedPreferences.isSPAAutoDetectPageUrlChangeEnabled()&&((()=>{let e=history.pushState;history.pushState=function(){let t=e.apply(this,arguments);return window.dispatchEvent(new Event("pushstate")),window.dispatchEvent(new Event("locationchange")),t};let t=history.replaceState;history.replaceState=function(){let e=t.apply(this,arguments);return window.dispatchEvent(new Event("replacestate")),window.dispatchEvent(new Event("locationchange")),e},window.addEventListener("popstate",(()=>{window.dispatchEvent(new Event("locationchange"))}))})(),window.addEventListener("locationchange",(function(){var t=window.location.href.split("?")[0];e.sharedPreferences.getCurrentPageUrl()==t||e.sharedPreferences.unInited||(e.uninit(),cfitinit())}))),cf_is_page_update_enabled&&this.startPeriodicTimer()}registerHubspotFormEvents(e){var t=function(e){return function(t){"hsFormCallback"===t.data.type&&"onFormReady"===t.data.eventName?e.sendFormEvents(t.data.id,null,"hubspot","form_view"):"hsFormCallback"===t.data.type&&"onFormSubmit"===t.data.eventName&&(e.sendFormEvents(t.data.id,t.data.data,"hubspot","form_submitted"),e.sharedPreferences.getUser().form_update_detected="true",e.updateUser())}}(e);P(window,"message",t)}sendFormEvents(e,t,r,s){try{if(!e)return;var i=this,n=(i.sharedPreferences.getLastTrackedPageProperties(),window.location.pathname.length>1?window.location.pathname.replace(/\/$/,""):window.location.pathname),o=new m.Builder("hs_form_"+e).withEventType("FORM");if(o.form_type=r,o.form_action=s,t)for(var a of t)"hs_context"!=a.name&&("email"==a.name&&(i.sharedPreferences.getUser().email=a.value),o=o.withEventProperty(a.name,a.value));var c=(o=(o=(o=o.withEventProperty("form_action",s)).withEventProperty("form_type",r)).withEventProperty("page_path",n)).build();c.form_type=r,c.form_action=s,i.track(c,!0,!0)}catch(e){console.error(e)}}registerAnyFormSubmit(e){var t=document.querySelectorAll("form");for(var r of t)try{r.addEventListener("submit",(function(t){try{e.sharedPreferences.getUser().form_update_detected="true",e.updateUser()}catch(t){console.error(t)}}),!1)}catch(e){console.error(e)}}registerOnDocumentLoadHandlers(e){if(cf_is_hubspot_enabled&&e.registerAnyFormSubmit(e),is_auto_form_capture){var t=document.querySelectorAll("form");!t||t.length<=0?setTimeout((function(){e._initContactCapture(e)}),5e3):e._initContactCapture(e)}}_initContactCapture(e){var t=document.querySelectorAll("form");if(t&&!(t.length<=0)){var r=e.user;for(var s of t)try{var i=s.querySelectorAll("input");if(i&&i.length>0)for(var n of i)if(null!=n.getAttribute("name")&&"text"==n.getAttribute("type")||"email"==n.getAttribute("type")||"tel"==n.getAttribute("type")){if("hidden"==n.getAttribute("type"))continue;P(n,"change",(function(){try{var t=!1;if("email"==this.type&&is_auto_email_capture){var s=this.value;s&&s.length>0&&r.properties.email!=s&&/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(s).toLowerCase())&&(r.properties.email=s,t=!0)}else if("tel"==this.type&&is_auto_phonenumber_capture){var i=this.value;i&&i.length>0&&r.properties.phone!=s&&(r.properties.phone=i,t=!0)}else"hidden"!=this.type&&this.value&&this.value.length>0&&r.properties[this.getAttribute("name").replace(/ /g,"_")]!=this.value&&(r.properties[this.getAttribute("name").replace(/ /g,"_")]=this.value,t=!0);t&&e.sharedPreferences.setUserInfo(r)}catch(e){console.error(e)}}),!1)}s.attachEvent?s.attachEvent("submit",(function(){e.updateUser()})):P(s,"submit",(function(){e.updateUser()}))}catch(e){console.error(e)}}}startPeriodicTimer(){var e=this,t=window.location.href.split("?");e.sharedPreferences.getPeriodicTimerId()&&clearInterval(e.sharedPreferences.getPeriodicTimerId());var r=setInterval((function(){1!=e.sharedPreferences.isSPA()||0!=e.sharedPreferences.isSPAAutoDetectPageUrlChangeEnabled()||e.sharedPreferences.getCurrentPageUrl()==t?e.sendPageUpdates():e.uninit()}),2e4);e.sharedPreferences.setPeriodicTimerId(r)}sendPageUpdates(e=!1){var t=this;if(!this.isPageBlackListedForTrack()){var r=t.sharedPreferences.getLastTrackedPageProperties(),s=window.location.pathname.length>1?window.location.pathname.replace(/\/$/,""):window.location.pathname,i=new m.Builder(s).withEventType("PAGE_UPDATE"),n=!1,o=t.sharedPreferences.getMaxScrollDepth();o>0&&o>=r.scroll_depth+.05*r.scroll_depth&&(i=i.withEventProperty("scroll_depth",parseFloat(o-r.scroll_depth).toFixed(3)),r.scroll_depth=o,t.sharedPreferences.setLastTrackedPageProperties(r),n=!0);var a=t.sharedPreferences.getPageClicks();r.click_count<a&&(i=i.withEventProperty("click_count",a-r.click_count),r.click_count=a,t.sharedPreferences.setLastTrackedPageProperties(r),n=!0);var c=t.sharedPreferences.getCurrentPageDuration();(e||n)&&(c<=18e5?(i=i.withEventProperty("current_page_duration",c-r.current_page_duration),r.current_page_duration=c,t.sharedPreferences.setLastTrackedPageProperties(r),n=!0):(r.current_page_duration=c,t.sharedPreferences.setLastTrackedPageProperties(r))),n&&(t.track(i.build(),!0,e),t.sharedPreferences.setLastTrackedPageProperties(r))}}extractCurrentPagePathInformation(e){var t=this.isCurrentPagePersonalized(e.page_paths);t.match_found&&this.sharedPreferences.setPageElementsPathType(t.matched_page_elememnt_type),this.sharedPreferences.setCurrentPagePersonalized(t.match_found),this.sharedPreferences.setPersonalizedPagePaths(e.page_paths)}makeDocumentVisible(e,t=!1){if(t||e&&"loading"!=document.readyState){if(cf_intelligent_code_enabled)this.removeAllHideStyles(!0);else if(cf_legacy)"hidden"===document.getElementsByTagName("HTML")[0].style.visibility&&(document.getElementsByTagName("HTML")[0].style.visibility="visible");else{var r=document.querySelector("html");r&&r.className&&(r.className=r.className.replace(/\bcustomfit-invisible-block\b/g,""))}this.documentMadeVisible=!0,cf_script_time_after_all_done=(new Date).getTime(),console.log("CustomFit:s1",cf_script_time_init,cf_script_time_before_config_call,cf_script_time_after_config_call,cf_script_time_after_all_done,JSON.stringify(cf_script_time_after_config_duriations))}}addDevice(e){try{if(!e&&sessionStorage.getItem("customfit_preview"))return;this.api.send("POST","/v1/users/"+this.sharedPreferences.getCFUserId()+"/devices",{add_devices:[{device_customer_id:e,device_type:"WEB",user_id:this.sharedPreferences.getCFUserId()}],anonymous:+this.sharedPreferences.getUser().anonymous}).then((t=>{localStorage.setItem(this.sharedPreferences.getStorageKeyPrefix()+"cf_user_device_id",e)}),(e=>{})).catch((e=>{}))}catch(e){}}_getConfigs(e){return this.sharedPreferences.getConfigs()}getSystemConfigPathMap(e){let t=new Map;try{for(var r in e)try{var s=e[r];"HTML_ELEMENT"==s.variation_data_type&&s.properties.page_path&&s.properties.element_path&&s.properties.system_created&&this.isConfigBelongsToCurrentPage(s)&&t.set(s.properties.element_path,s)}catch(e){console.log("CustomFit.ai, error:",e)}}catch(e){console.log("CustomFit.ai, error:",e)}return t}isConfigBelongsToCurrentPage(e){var t=window.location.pathname,r=window.location.pathname.replace(/\/$/,""),s="exact_match",i=!1;try{if(e.properties.page_match&&e.properties.page_match.length>0&&(s=e.properties.page_match),"contains"===s){for(var n of e.properties.page_path.split(","))if(t.includes(n)){i=!0;break}}else if("regex"===s){for(var n of e.properties.page_path.split(","))if(t.match(n)){i=!0;break}}else r===e.properties.page_path.replace(/\/$/,"")&&(i=!0)}catch(e){}return i}handleManualcreatedConfigs(e,t){try{for(var r in e)try{var s=e[r];"HTML_ELEMENT"==s.variation_data_type&&s.properties&&s.properties.page_path&&!s.properties.system_created&&window.location.pathname.replace(/\/$/,"")===s.properties.page_path.replace(/\/$/,"")&&this.replaceElementInPath(s.properties.element_path,s,t)}catch(e){console.log("CustomFit.ai, error:",e)}}catch(e){console.log("CustomFit.ai, error:",e)}}updatePageElements(e,t,r=!1,s=!0){try{this.actionConfigs=[];var i=this.getSystemConfigPathMap(e);if(cf_intelligent_code_enabled&&this.makeVisibleNonPersonalizedElements(i),this._updatePageElements(i,e,t),t)try{this.sendCurrentPageEvents(),this.handleActions()}catch(e){console.log("CustomFit.ai, error:",e)}var n=!0;if(i.forEach((function(e,t){e&&!e.replaced&&(n=!1)})),n)this.makeDocumentVisible(s,!0);else{var o=this;try{P(document,"DOMContentLoaded",(function(r){let n=new Map;i.forEach((function(e,t){e&&!e.replaced&&n.set(t,e)})),o._updatePageElements(n,e,t),o.makeDocumentVisible(s)}),!1)}catch(e){}}this.delayedReplaceElement(i,e,t)}catch(e){console.log("CustomFit.ai, error:",e)}}sendCurrentPageEvents(){if(this.sendPageTrack&&!this.isPageBlackListedForTrack()){var e=window.location.pathname.length>1?window.location.pathname.replace(/\/$/,""):window.location.pathname;this.track(new m.Builder(e).withEventType("PAGE").build(),!0)}this.preInitTrackMessages&&this.preInitTrackMessages.length>0&&(this.preInitTrackMessages.forEach((function(e){this.track(e),summaryExporter})),this.preInitTrackMessages=[])}_updatePageElements(e,t,r){try{var s=(new Date).getTime();for(var i of(cf_skip_dfs||this.dfsReplace(document.querySelector("body"),e,r),e.keys()))try{if(this.sharedPreferences.getReplacedElementsConfigMap().get(i))continue;var n=e.get(i);if(document.querySelector(n.properties.element_path))this.replaceElementInPath(n.properties.element_path,n,r);else{var o=this;this.notifyElementLoad(e.get(i),r).then((function(e){if(e){var t=e[1],r=e[2];o.replaceElementInPath(t.properties.element_path,t,r)}})).catch((function(e){}))}}catch(e){console.log(e)}if(r&&"loading"!=document.readyState){this.addCustomElements(t,e,r);var a=document.getElementsByClassName("cfit-custom-template");if(a)for(var c of a)this.dfsReplace(c,e,r)}var l=(new Date).getTime();cf_script_time_after_config_duriations.push(l-s),console.log("CustomFit:st ",JSON.stringify(cf_script_time_after_config_duriations))}catch(e){console.log(e)}this.handleManualcreatedConfigs(t,r)}handleActions(){for(let e of this.actionConfigs)this._handleAction(e);this.actionConfigs=[]}_handleAction(e){try{if(e.variation&&e.variation.customfit_meta){var t=e.variation.customfit_meta;if(e.variation.customfit_meta.is_default&&e.experience_behaviour_response&&e.experience_behaviour_response.experience_id&&((t=e.variation.customfit_meta.experience[e.experience_behaviour_response.experience_id]).is_default=!0,t.experience_id=e.experience_behaviour_response.experience_id),t&&t.onclick_action&&t.onclick_action.action_txt&&t.onclick_action.action_txt.length>0)try{var r=document.querySelector(e.properties.element_path);if(r){var s=this,i=(n=t,o=e,function(){try{if("track_click"==n.onclick_action.action_type){var e=window.location.pathname.length>1?window.location.pathname.replace(/\/$/,""):window.location.pathname;s.track(new m.Builder(n.onclick_action.action_txt).withEventType("CLICK").withEventProperty("page_path",e).build(),!0)}else if("execute_javascript"==n.onclick_action.action_type)"inline_js"==cf_jsevl_type?S(o.config_id,o.variation_id,n.experience_id,n.is_default,"on_click"):cf_ev_method(n.onclick_action.action_txt);else if("track_click_and_execute_javascript"==n.onclick_action.action_type)try{var t=JSON.parse(n.onclick_action.action_txt);e=window.location.pathname.length>1?window.location.pathname.replace(/\/$/,""):window.location.pathname,s.track(new m.Builder(t.goal_name).withEventType("CLICK").withEventProperty("page_path",e).build(),!0),"inline_js"==cf_jsevl_type?S(o.config_id,o.variation_id,n.experience_id,n.is_default,"on_click"):cf_ev_method(t.js_code)}catch(e){console.log(e)}}catch(e){console.log(e)}});try{"IFRAME"==r.tagName?(top.focus(),b(r,"focus",i),P(r,"focus",i)):(b(r,"click",i),P(r,"click",i))}catch(e){console.error(e)}}}catch(e){console.error(e)}if(t&&t.onload_action&&"execute_javascript"==t.onload_action.action_type&&t.onload_action.action_txt&&t.onload_action.action_txt.length>0)try{"inline_js"==cf_jsevl_type?S(e.config_id,e.variation_id,t.experience_id,t.is_default,"on_load"):cf_ev_method(t.onload_action.action_txt)}catch(e){console.error(e)}if(t&&t.move_action)try{this.moveElement(t.move_action.target_elem,t.move_action.first_elem,t.move_action.position)}catch(e){console.log(e)}if(t&&t.swap_action)try{this.swapElements(t.swap_action.first_elem,t.swap_action.target_elem)}catch(e){console.log(e)}}}catch(e){console.error(e)}var n,o}delayedReplaceElement(e,t,r){var s=this,i=s.sharedPreferences.getReplacedElementsConfigMap();for(var n of e.keys())if(!i.get(n))break;try{const i=cf_config_reapply_timers.split(",").filter((e=>""!==e.trim()&&!isNaN(e))).map((e=>Number(e)));for(var o of i){var a=setTimeout((function(){var i,n,o;i=e,n=t,o=r,s.sharedPreferences.hasElementsMoved()||s.sharedPreferences.hasElementsSwpped()||(s._updatePageElements(i,n,o),o&&(s.handleActions(),s.summaryExporter.sendSummaries()))}),o);s.sharedPreferences.saveTimerId(a)}}catch(e){console.error(e)}}cleanSelectorID(e){try{let t,r=e.charAt(0);!isNaN(parseInt(r))&&(r=CSS.escape(r),t=e.slice(1),e=r.concat(t))}catch(e){console.log(e)}return`${e}`.toString()}cssPath(e){if(!(e instanceof Element))return;const t=e;for(var r=[];e.nodeType===Node.ELEMENT_NODE;){var s=e.nodeName.toLowerCase(),i=!1;if(e.id&&("ELEMENTS_BY_ID"==this.sharedPreferences.getPageElementsPathType()||"ELEMENTS_BY_ID_CLASS"==this.sharedPreferences.getPageElementsPathType()))try{1==document.querySelectorAll('[id="'+e.id+'"]').length&&(i=!0)}catch(e){i=!1}if(i){s+="#"+this.cleanSelectorID(e.id).replaceAll(":","\\:"),r.unshift(s);break}if(("ELEMENTS_BY_ID_CLASS"==this.sharedPreferences.getPageElementsPathType()||"ELEMENTS_BY_CLASS"==this.sharedPreferences.getPageElementsPathType())&&e.classList&&e.classList.length>0){var n=!1,o=e.parentElement;if(!o)break;for(var a=0;a<e.classList.length;a++){var c=e.classList[a].replaceAll(":","\\:");if(1==[].filter.call(o.children,(function(e){return[].indexOf.call(e.classList,c)>=0})).length&&1==document.querySelectorAll('[class="'+c+'"]').length){var l=r.slice();if(l.unshift(s+"."+c),document.querySelector(l.join(" > "))==t){s+="."+c,n=!0;break}}}if(n){r.unshift(s);break}}for(var u=e,p=1;u=u.previousElementSibling;)u.nodeName.toLowerCase()==s&&p++;1!=p&&(s+=":nth-of-type("+p+")"),r.unshift(s),e=e.parentNode}return r.join(" > ")}replaceElementInPath(e,t,r){let s=t.variation,i=document.querySelector(e),n=this.sharedPreferences.getDeviceType();if(i&&!(s&&s.customfit_meta&&s.customfit_meta.custom_template)){var o=!0;t.replaced&&(o=!1);var a,c=!1;for(var l of Object.keys(s))try{if("customfit_meta"===l&&r&&o){c=!0;continue}if("style"===l)for(var u of Object.keys(s[l]))("position"!=u&&"top"!=u&&"left"!=u||"desktop"==n)&&s[l][u]&&s[l][u].length>0&&(cf_intelligent_code_enabled&&"backgroundImage"==u&&i.style[u]!=s[l][u]&&(i.style[u]="unset"),i.style[u]=s[l][u],i.style.setProperty(u,s[l][u],"important"));if("srcset"==l&&(i.getAttribute("data-lazy-srcset")&&i.setAttribute("data-lazy-srcset",s[l].replace(/\\"/g,'"')),i.getAttribute("data-srcset")&&i.setAttribute("data-srcset",s[l].replace(/\\"/g,'"')),i.getAttribute("data-ws-srcset")&&i.setAttribute("data-ws-srcset",s[l].replace(/\\"/g,'"'))),"src"==l)if(i.getAttribute("data-lazy-src")&&i.setAttribute("data-lazy-src",s[l].replace(/\\"/g,'"')),i.getAttribute("data-src")&&i.setAttribute("data-src",s[l].replace(/\\"/g,'"')),i.getAttribute("data-ws-src")&&i.setAttribute("data-ws-src",s[l].replace(/\\"/g,'"')),i.getAttribute("data-mfp-src")&&i.setAttribute("data-mfp-src",s[l].replace(/\\"/g,'"')),cf_intelligent_code_enabled&&i[l]!=s[l]){var p=this.sharedPreferences.getHiddenElementsConfigMap().get(t.properties.element_path);if(p){t.imageChange=!0,p.imageChange=!0;var h=this;P(i,"load",a=function(){h.removeHideStyles(t)}),P(i,"error",a)}}else"IMG"!==i.tagName||cf_intelligent_code_enabled||i[l]==s[l]||(i.classList?i.classList.add("customfit-invisible-block"):i.className&&(i.className=html_ele.className+" customfit-invisible-block"),function(e,t,r){var s=function(t){e.src==r&&(e.style.transition=".1s all",e.className=e.className.replace(/\bcustomfit-invisible-block\b/g,""))};P(i,"load",s),P(i,"error",s)}(i,0,s[l]));if(!isNaN(s[l])&&s[l].length>0)i[l]=Number(s[l]);else if("string"==typeof s[l]){if("cf_classes_edit_option"===l&&s[l]&&"no_changes"!=s[l])if("add_remove_classes"==s[l]){if(s.cf_classes_add&&s.cf_classes_add.length>0)for(var d of s.cf_classes_add.split(" "))i.classList.add(d);if(s.cf_classes_remove&&s.cf_classes_remove.length>0)for(var f of s.cf_classes_remove.split(" "))i.classList.remove(f)}else"overwrite_classes"==s[l]&&s.cf_classes_overwrite.length>0&&((" "+i.className+" ").indexOf(" customfit-invisible-block ")>-1?i.setAttribute("class",s.cf_classes_overwrite.replace(/\\"/g,'"')+" customfit-invisible-block"):i.setAttribute("class",s.cf_classes_overwrite.replace(/\\"/g,'"')));else"href_target"===l?i.setAttribute("target",s[l].replace(/\\"/g,'"')):i[l]!=s[l]&&(i[l]=s[l].replace(/\\"/g,'"'));"innerHTML"!=l&&"value"!=l||"true"!=s.cf_retain_value||!r||!o||t.innerHTMLObserver||(t.replacementCount=0,function(e,t,r,s){try{if(null==r||null==r)return;var i=new MutationObserver((function(i,n){e[t]!=r&&s.replacementCount<300?(e[t]=r,s.replacementCount++):s.replacementCount>300&&n.disconnect()}));i.observe(e,{characterData:!0,childList:!0,subtree:!0,attributes:!0}),s.innerHTMLObserver=i}catch(e){console.error(e)}}(i,l,s[l],t)),cf_retain_text_value&&"innerHTML"==l&&r&&o&&!t.innerHTMLObserver&&(t.replacementCount=0,function(e,t,r){try{var s=new MutationObserver((function(s,i){e.innerHTML!=t&&r.replacementCount<300?(e.innerHTML=t,r.replacementCount++):r.replacementCount>300&&i.disconnect()}));s.observe(e,{characterData:!0,childList:!0,subtree:!0,attributes:!0}),r.innerHTMLObserver=s}catch(e){console.error(e)}}(i,s[l],t))}}catch(e){console.error(e)}return t.replaced=!0,"INPUT"==i.tagName&&i.dispatchEvent(new Event("change")),cf_intelligent_code_enabled&&!t.imageChange&&this.removeHideStyles(t,!1),r&&o&&(c&&(t.variation&&t.variation.customfit_meta&&(t.variation.customfit_meta.swap_action||t.variation.customfit_meta.move_action)?this.actionConfigs.push(t):this._handleAction(t)),this.sharedPreferences.getReplacedElementsConfigMap().set(t.properties.element_path,t),this.summaryExporter._queueSummary(t)),!0}}addCustomTemplateStyles(e){var t="";return e&&e.template_properties&&(t=JSON.parse(e.template_properties).root_style),t}insertDynamicJS(e,t,r){let s=document.createElement("script");s.id="js_"+e,s.innerHTML=r,document.body.appendChild(s)}trackTemplateView(e,t,r,s,i){try{var n=(l=s,function(t){try{var s=JSON.parse(JSON.stringify(r.experience_behaviour_response));s.template_id=l,s.button_clicked=t.target.innerText,e.track(new m.Builder(l).withEventType("TEMPLATE_BUTTON_CLICK").withEventProperty("template_info",s).build(),!0)}catch(e){console.log(e)}}),o=t.querySelectorAll("a");for(var a of o)P(a,"click",n);if(!e.sharedPreferences.getTemplateImpressionMap().get(s)){var c=JSON.parse(JSON.stringify(r.experience_behaviour_response));c.template_id=s,e.track(new m.Builder(s).withEventType("TEMPLATE_VIEW").withEventProperty("template_info",c).build(),!0),r.template_info=c,e.summaryExporter._queueSummary(r),e.sharedPreferences.getTemplateImpressionMap().set(s,!0)}}catch(e){console.error(e)}var l}handleTemplateDisplayActions(e,t,r){var s=document.getElementById(t),i=this;if(s&&r&&r.config_selected){if("on_entry"==r.config_selected)return s.style.display="",s.style.visibility="",void i.trackTemplateView(i,s,e,t,r);if("on_click"==r.config_selected)try{var n=r.on_click_config.element_list;for(var o of n)!function(e,t,r,s,n){try{var o=document.querySelector(e);o&&P(o,"click",(function(e){try{var o=document.getElementById(s);o&&(o.style.display="block",o.style.visibility="visible",i.trackTemplateView(i,r,t,s,n))}catch(e){console.log(e)}}))}catch(e){console.log(e)}}(o,e,s,t,r)}catch(e){console.log(e)}else"at_exit"==r.config_selected?function(e,t,r){try{var s=r.at_exit_config.delay;s<0&&(s=1);var n=setTimeout((function(s){var n=function(){try{P(document,"mouseout",(function(s){var o=(s=s||window.event).relatedTarget||s.toElement;if(!o||"HTML"===o.nodeName){var a=document.getElementById(t);a&&(a.style.display="block",a.style.visibility="visible",i.trackTemplateView(i,a,e,t,r),b(document,"mouseout",n))}}))}catch(e){console.error(e)}};P(document,"mouseout",n)}),1e3*s);i.sharedPreferences.saveTimerId(n)}catch(e){console.error(e)}}(e,t,r):"timerbased"==r.config_selected?function(e,t,r){if(r.timerdisplay_config){var s=r.timerdisplay_config.timeout;s<0&&(s=1);var n=setTimeout((function(s){var n=document.getElementById(t);n&&(n.style.display="block",n.style.visibility="visible",i.trackTemplateView(i,n,e,t,r))}),1e3*s);i.sharedPreferences.saveTimerId(n)}}(e,t,r):"on_scroll"==r.config_selected&&function(e,t,r){try{var s=function(){try{var n=i.getCurrentPageScrollPercentage();if(n>0&&n>=r.on_scroll_config.scroll_percentage){var o=document.getElementById(t);o&&(o.style.display="block",o.style.visibility="visible",i.trackTemplateView(i,o,e,t,r),b(document,"scroll",s))}}catch(e){console.error(e)}};P(document,"scroll",s)}catch(e){console.error(e)}}(e,t,r)}}insertHTMLTemplate(e,t,r,s,i){var n=this;try{let d=this.sharedPreferences.getDeviceType();if(document.getElementById(t.id))return;if(sessionStorage.getItem("cf_popup_closed_"+t.id))return;var o=document.createElement("div");o.style.position="relative",o.style.textAlign="center";const f=this.addCustomTemplateStyles(t.properties);f&&(o.style.cssText=f),o.className="cfit-custom-template",o.innerHTML=r,o.id=t.id;var a=null;try{t.properties&&t.properties.properties.settings&&(a=t.properties.properties.settings,o.style.display="none",o.style.visibility="hidden")}catch(e){}try{if(a&&a.visibility_selected){if("hide_template"==a.visibility_selected)return;if("desktop"==d&&"mobile_only"==a.visibility_selected)return;if("mobile"==d&&"desktop_only"==a.visibility_selected)return}if(a&&a.close_settings&&a.close_settings.close_config_selected){var c=localStorage.getItem("cf_popup_closed_"+t.id);if(c){var l=c.split(";")[0],u=parseInt(c.split(";")[1]);if("next_session"==a.close_settings.close_config_selected){if(l==window.customFit.sharedPreferences.sessionId)return}else if("duration"==a.close_settings.close_config_selected){var p=new Date;if(Math.floor(p/1e3)<u+parseInt(a.close_settings.close_duration_settings.expiry))return}localStorage.removeItem("cf_popup_closed_"+t.id),sessionStorage.removeItem("cf_popup_closed_"+t.id)}}}catch(e){}const m=t.nextSibling&&document.querySelector(t.nextSibling);if(document.querySelector(t.parentElement))if(document.querySelector(t.parentElement).insertBefore(o,m))try{a&&this.handleTemplateDisplayActions(e,t.id,a);try{var h=JSON.parse(t.properties.template_properties).js_script;if(h&&h.length>0&&(h=h.replace("{{cf_template_id}}","'"+t.id+"'"),h="(function(){ let template_id = '"+t.id+"';let   template_settings = "+JSON.stringify(a)+";"+h+"})()",this.insertDynamicJS(t.id,a,h)),!e.variation||"true"!=e.variation.cf_retain_value)return;!function(e,t,r,s,i,o,a){try{if(null==e.replacementCount||null==e.replacementCount){e.replacementCount=0;var c=new MutationObserver((function(o,a){try{if(!(o&&o.length>0&&o[0].removedNodes))return;var c=!1;for(var l of o[0].removedNodes)if(l.id&&l.id==t.id){c=!0;break}if(c&&e.replacementCount<2){if(!sessionStorage.getItem("cf_popup_closed_"+t.id)){n.insertHTMLTemplate(e,t,r,s,i);var u=document.getElementById(t.id);u&&n.dfsReplace(u,s,i),a.disconnect()}e.replacementCount++}}catch(e){console.error(e),a.disconnect()}}));c.observe(document.querySelector(a),{childList:!0}),e.innerHTMLObserver=c}}catch(e){console.error(e)}}(e,t,r,s,i,0,t.parentElement)}catch(e){console.error(e)}}catch(e){console.error(e)}}catch(e){console.error(e)}}addCustomElements(e,t,r){var s=new Map,i=[];for(var n of Object.keys(e))try{if((u=e[n]).variation.customfit_meta&&u.variation.customfit_meta.custom_template){var o=u.variation.customfit_meta.custom_template,a=(o.parentElement?o.parentElement:"")+"|"+(o.nextSibling?o.nextSibling:""),c=s.get(a);c?c.experience_behaviour_response&&u.experience_behaviour_response&&c.experience_behaviour_response.priority&&u.experience_behaviour_response.priority&&c.experience_behaviour_response.experience_created_time&&u.experience_behaviour_response.experience_created_time&&(u.experience_behaviour_response.priority>c.experience_behaviour_response.priority||u.experience_behaviour_response.priority==c.experience_behaviour_response.priority&&u.experience_behaviour_response.experience_created_time>=c.experience_behaviour_response.experience_created_time)&&(u.properties&&u.properties.custom_template&&u.properties.custom_template.properties&&u.properties.custom_template.properties.properties&&u.properties.custom_template.properties.properties.alignment&&u.properties.custom_template.properties.properties.alignment,s.delete(a),s.set(a,u)):(s.set(a,u),i.push(u))}}catch(e){}for(var l of s.keys()){var u;const e=(u=s.get(l)).variation.customfit_meta.custom_template;u.variation&&u.variation.innerHTML&&this.insertHTMLTemplate(u,e,u.variation.innerHTML,t,r)}}dfsReplace(e,t,r){if(t&&e instanceof Element){var s=this.cssPath(e);if(t.has(s)){let e=t.get(s);this.replaceElementInPath(s,e,r)}e.childNodes.forEach((e=>{this.dfsReplace(e,t,r)}))}}track(e,t=!1,r=!1){this.eventTracker&&this.eventTracker.trackEvent(e,t,r)}makeVisibleNonPersonalizedElements(e){var t=this.sharedPreferences.getHiddenElementsConfigMap();if(t)for(var r of t.keys())try{e.get(r)||this.removeHideStyles(t.get(r))}catch(e){console.log(e)}}notifyElementLoad(e,t){var r,s,i=this;return r=e,s=t,new Promise((function(e,t){var n=document.querySelector(r.properties.element_path);if(n)e([n,r,s]);else if(i.sharedPreferences.getActiveElementLoadObserverConfigMap().get(r.properties.element_path))t();else{var o=null,a=setTimeout((function(){o&&o.disconnect();var t=document.querySelector(r.properties.element_path);t&&e([t,r,s]),i.sharedPreferences.getActiveElementLoadObserverConfigMap().delete(r.properties.element_path)}),r.variation&&r.variation.cf_evt_load_time&&r.variation.cf_evt_load_time>0?r.variation.cf_evt_load_time:cf_sdk_timeout_in_seconds);i.sharedPreferences.saveTimerId(a),(o=new MutationObserver((function(t){t.forEach((function(t){var n=Array.from(t.addedNodes);for(var c of n)if(c.matches&&c.matches(r.properties.element_path)||c.querySelector&&"function"==typeof c.querySelector&&c.querySelector(r.properties.element_path))try{return i.replaceElementInPath(r.properties.element_path,r,s),i.sharedPreferences.getActiveElementLoadObserverConfigMap().delete(r.properties.element_path),o.disconnect(),clearTimeout(a),void e()}catch(e){o.disconnect(),console.log(e)}}))}))).observe(document.documentElement,{childList:!0,subtree:!0}),i.sharedPreferences.getActiveElementLoadObserverConfigMap().set(r.properties.element_path,!0)}}))}isCurrentPagePersonalized(e){var t=window.location.pathname.replace(/\/$/,""),r=window.location.pathname,s="ELEMENTS_BY_ID",i=!1;if(e){if(e.page_paths_exact_match_list)for(var n of e.page_paths_exact_match_list)if(t===n.page_path.replace(/\/$/,"")){i=!0,n.page_elements_path_type&&(s=n.page_elements_path_type);break}if(!i&&e.page_paths_contains_list)for(var o of(r=window.location.pathname,e.page_paths_contains_list)){for(var a of o.target_text_list)if(r.includes(a)){i=!0,o.page_elements_path_type&&(s=o.page_elements_path_type);break}if(i)break}if(!i&&e.page_paths_regex_list)for(var o of(r=window.location.pathname,e.page_paths_regex_list)){for(var a of o.target_text_list)if(r.match(a)){i=!0,o.page_elements_path_type&&(s=o.page_elements_path_type);break}if(i)break}}return{match_found:i,matched_page_elememnt_type:s}}isPageBlackListedForTrack(){if(blacklisted_page_paths&&blacklisted_page_paths.length>0){var e=window.location.href;for(var t of blacklisted_page_paths)if(e.match(t))return!0}return!1}isReferrerBlackListed(e){if(e&&e.length>0&&blacklisted_referrers&&blacklisted_referrers.length>0)for(var t of blacklisted_referrers)if(e.match(t))return!0;return!1}makeElementInvisible(e,t){try{t||(t=document.getElementsByTagName("head")[0]);var r=document.createElement("style"),s=e.properties.element_path+"{ opacity:0 !important; }";return r.type="text/css",r.className="customfit-invisible-style",r.id="cf_style_"+e.config_id,r.setAttribute("data-customfit-selector",e.properties.element_path),r.appendChild(document.createTextNode(s)),t.appendChild(r),!0}catch(e){}return!1}removeAllHideStyles(e=!1){for(var t=document.querySelectorAll(".customfit-invisible-style"),r=0;t&&r<t.length;r++)try{var s=t[r].getAttribute("data-customfit-selector");if(s){var i=document.querySelector(s),n=this.sharedPreferences.getHiddenElementsConfigMap().get(s);if(e&&n&&n.imageChange)continue;i&&(i.style.transition=".1s all")}t[r].parentNode.removeChild(t[r]),this.sharedPreferences.getHiddenElementsConfigMap().delete(s)}catch(i){}this.summaryExporter&&this.summaryExporter.sendSummaries()}removeHideStyles(e,t=!0){if(e){var r=document.getElementById("cf_style_"+e.config_id);if(r){if(t){var s=document.querySelector(e.properties.element_path);s&&(s.style.transition=".1s all")}r.remove(),this.sharedPreferences.getHiddenElementsConfigMap().get(e.properties.element_path)&&this.sharedPreferences.getHiddenElementsConfigMap().delete(e.properties.element_path),0==this.sharedPreferences.getHiddenElementsConfigMap().size&&this.summaryExporter.sendSummaries()}}}hideElementsIfNeeded(){try{var e=document.getElementsByTagName("head")[0];for(var t of cf_configs)this.isConfigBelongsToCurrentPage(t)&&this.makeElementInvisible(t,e)&&this.sharedPreferences.getHiddenElementsConfigMap().set(t.properties.element_path,t)}catch(e){console.log("CustomFit Exception: ",e)}}getNumber(e,t){try{return null==this._getConfigs()||null==this._getConfigs()||null==this._getConfigs()[e]||null==this._getConfigs()[e]||"NUMBER"!=this._getConfigs()[e].variation_data_type?t:(this.summaryExporter.pushSummary(this._getConfigs()[e]),this._getConfigs()[e].variation)}catch(e){return t}}getString(e,t){try{return null==this._getConfigs()||null==this._getConfigs()||null==this._getConfigs()[e]||null==this._getConfigs()[e]||"STRING"!=this._getConfigs()[e].variation_data_type?t:(this.summaryExporter.pushSummary(this._getConfigs()[e]),this._getConfigs()[e].variation)}catch(e){return t}}getBoolean(e,t){try{return null==this._getConfigs()||null==this._getConfigs()||null==this._getConfigs()[e]||null==this._getConfigs()[e]||"BOOLEAN"!=this._getConfigs()[e].variation_data_type?t:(this.summaryExporter.pushSummary(this._getConfigs()[e]),this._getConfigs()[e].variation)}catch(e){return t}}getImage(e,t){try{return null==this._getConfigs()||null==this._getConfigs()||null==this._getConfigs()[e]||null==this._getConfigs()[e]||"STRING"!=this._getConfigs()[e].variation_data_type?t:(this.summaryExporter.pushSummary(this._getConfigs()[e]),this._getConfigs()[e].variation)}catch(e){return t}}getList(e,t){try{return null==this._getConfigs()||null==this._getConfigs()||null==this._getConfigs()[e]||null==this._getConfigs()[e]||"LIST"!=this._getConfigs()[e].variation_data_type?t:(this.summaryExporter.pushSummary(this._getConfigs()[e]),this._getConfigs()[e].variation)}catch(e){return t}}getColor(e,t){try{return null==this._getConfigs()||null==this._getConfigs()||null==this._getConfigs()[e]||null==this._getConfigs()[e]||"COLOR"!=this._getConfigs()[e].variation_data_type?t:(this.summaryExporter.pushSummary(this._getConfigs()[e]),this._getConfigs()[e].variation)}catch(e){return t}}getRichText(e,t){try{return null==this._getConfigs()||null==this._getConfigs()||null==this._getConfigs()[e]||null==this._getConfigs()[e]||"RICHTEXT"!=this._getConfigs()[e].variation_data_type?t:(this.summaryExporter.pushSummary(this._getConfigs()[e]),this._getConfigs()[e].variation)}catch(e){return t}}getJson(e,t){try{return null==this._getConfigs()||null==this._getConfigs()||null==this._getConfigs()[e]||null==this._getConfigs()[e]||"JSON"!=this._getConfigs()[e].variation_data_type?t:(this.summaryExporter.pushSummary(this._getConfigs()[e]),this._getConfigs()[e].variation)}catch(e){return t}}moveElement(e,t,r){try{var s=document.querySelector(e),i=document.querySelector(t);"above"==r?this.moveElementAbove(s,i):this.moveElementBelow(s,i)}catch(e){console.error(e)}}moveElementAbove(e,t){try{var r,s,i=e.parentNode,n=t.parentNode;if(!i||!n||i.isEqualNode(t)||n.isEqualNode(e))return;for(var o=0;o<i.children.length;o++)i.children[o].isEqualNode(e)&&(r=o);for(o=0;o<n.children.length;o++)n.children[o].isEqualNode(t)&&(s=o);i.isEqualNode(n)&&r<s&&s++,i.insertBefore(t,i.children[r])}catch(e){console.log(e)}}moveElementBelow(e,t){try{var r,s,i=e.parentNode,n=t.parentNode;if(!i||!n||i.isEqualNode(t)||n.isEqualNode(e))return;for(var o=0;o<i.children.length;o++)i.children[o].isEqualNode(e)&&(r=o);for(o=0;o<n.children.length;o++)n.children[o].isEqualNode(t)&&(s=o);i.isEqualNode(n)&&r<s&&s++,i.insertBefore(t,e.nextSibling),this.sharedPreferences.setElementsMoved(!0)}catch(e){console.log(e)}}swapElements(e,t){try{var r,s,i=document.querySelector(e),n=document.querySelector(t),o=i.parentNode,a=n.parentNode;if(!o||!a||o.isEqualNode(n)||a.isEqualNode(i))return;for(var c=0;c<o.children.length;c++)o.children[c].isEqualNode(i)&&(r=c);for(c=0;c<a.children.length;c++)a.children[c].isEqualNode(n)&&(s=c);o.isEqualNode(a)&&r<s&&s++,o.insertBefore(n,o.children[r]),a.insertBefore(i,a.children[s]),this.sharedPreferences.setElementsSwapped(!0)}catch(e){console.log(e)}}}var w=null,P=function(e,t,r){e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent&&e.attachEvent("on"+t,r),w.saveRegEventHandler({obj:e,event:t,callback:r})},b=function(e,t,r){e.removeEventListener?e.removeEventListener(t,r,!1):e.detachEvent&&e.detachEvent("on"+t,r)},S=function(e,t,r,s,i){try{var n=document.createElement("script"),o="prod"==cf_setup_env?"https://cdn.customfit.ai":"https://cdn.customfit.ai/stage";n.src=s?`${o}/${cf_dimension_id}/jss/${e}_${t}_${r}_${i}.js`:`${o}/${cf_dimension_id}/jss/${e}_${t}_${i}.js`,n.type="text/javascript",n.className="customfit-js",document.body.appendChild(n)}catch(e){console.error(e)}}})(),CustomFit=s})();try{(function() {
	// Union of Chrome, Firefox, IE, Opera, and Safari console methods
	var methods = ["log","error", "info", "warn"];
	var length = methods.length;
	var console = (window.console = window.console || {});
	var method;
	var noop = function() {};
	while (length--) {
	  method = methods[length];
	  // define undefined methods as noops to prevent errors
	  if (!console[method])
		console[method] = noop;
	}
})();}catch(e){}


var cf_key = cf_key || undefined;
var cf_intelligent_code_enabled = cf_intelligent_code_enabled || false;
var cf_configs = cf_configs || undefined;
var cf_page_paths = cf_page_paths || undefined;
var cf_legacy = document.getElementById('customfitinit') ? false:true;
var cf_sdk_version = cf_sdk_version || "0.0.21";
var cf_spa = cfspa || undefined;
var cf_spa_auto_detect_page_url_change = cfspa_auto_detect_page_url_change || undefined;
var cf_sdk_timeout_in_seconds = cf_sdk_timeout_in_seconds || 3000;
var cf_personalize_post_sdk_timeout = cf_personalize_post_sdk_timeout == undefined? true:cf_personalize_post_sdk_timeout ;
var cf_latest_sdk_version = cf_latest_sdk_version ||"0.0.21";
var cf_account_enabled = cf_account_enabled == undefined ? true:cf_account_enabled;
var blacklisted_page_paths = blacklisted_page_paths || [];
var blacklisted_referrers = blacklisted_referrers || [];
var is_auto_form_capture = is_auto_form_capture || false;
var is_auto_email_capture = is_auto_email_capture || false;
var is_auto_phonenumber_capture = is_auto_phonenumber_capture || false;
var cf_is_inbound =  cf_is_inbound == undefined ? true:cf_is_inbound;
var cf_is_outbound = cf_is_outbound == undefined ? true:cf_is_outbound;
var cf_ev_method = eval;
var cf_is_page_update_enabled = cf_is_page_update_enabled == undefined ? true: cf_is_page_update_enabled;
var cf_config_reapply_timers = cf_config_reapply_timers || "2000";
var cf_is_hubspot_enabled = cf_is_hubspot_enabled == undefined ? false:cf_is_hubspot_enabled;
var cf_retain_text_value = cf_retain_text_value == undefined ? false:cf_retain_text_value;
var cf_personalized_users_limit_exceeded = cf_personalized_users_limit_exceeded == undefined ? false: cf_personalized_users_limit_exceeded;
var cf_skip_dfs = cf_skip_dfs == undefined ? false : cf_skip_dfs;
var cf_domain_url = cf_domain_url || window.location.host
var cf_subdomains = cf_subdomains || [];
var cf_script_time_init = new Date().getTime();
var cf_script_time_before_config_call = null;
var cf_script_time_after_config_call = null;
var cf_script_time_after_config_duriations = [];
var cf_script_time_after_all_done = null;
var cf_skip_sdk = cf_skip_sdk == undefined ? false : cf_skip_sdk;
var cf_jsevl_type = cf_jsevl_type || "default";
var cf_dimension_id = cf_dimension_id || "";
var cf_setup_env = cf_setup_env || "prod";

function removeCFInvisibleCode() {
	var html_ele =  document.querySelector("html");
	html_ele.className = html_ele.className.replace(/\bcustomfit-invisible-preinit-block\b/g, "");
	var a = document.getElementById("customfit-invisible-preinit-css-block");
	if (a) a.parentNode.removeChild(a);
}

var bots = [
    "(Pingdom.com_bot_version_)(\d+)\.(\d+)", // Pingdom
    "(facebookexternalhit)/(\d+)\.(\d+)", // Facebook
    "Google.*/\+/web/snippet", // Google Plus
    "(Twitterbot)/(\d+)\.(\d+)", // Twitter
    "/((?:Ant-)?Nutch|[A-z]+[Bb]ot|[A-z]+[Ss]pider|Axtaris|fetchurl|Isara|ShopSalad|Tailsweep)[ \-](\d+)(?:\.(\d+)(?:\.(\d+))?)?", // Bots Pattern '/name-0.0'
    "(008|Altresium|Argus|BaiduMobaider|BoardReader|DNSGroup|DataparkSearch|EDI|Goodzer|Grub|INGRID|Infohelfer|LinkedInBot|LOOQ|Nutch|PathDefender|Peew|PostPost|Steeler|Twitterbot|VSE|WebCrunch|WebZIP|Y!J-BR[A-Z]|YahooSeeker|envolk|sproose|wminer)/(\d+)(?:\.(\d+)(?:\.(\d+))?)?", //Bots Pattern 'name/0.0'
    "(MSIE) (\d+)\.(\d+)([a-z]\d?)?;.* MSIECrawler", //MSIECrawler
    "(Google-HTTP-Java-Client|Apache-HttpClient|http%20client|Python-urllib|HttpMonitor|TLSProber|WinHTTP|JNLP)(?:[ /](\d+)(?:\.(\d+)(?:\.(\d+))?)?)?", // Downloader ...
    "(1470\.net crawler|50\.nu|8bo Crawler Bot|Aboundex|Accoona-[A-z]+-Agent|AdsBot-Google(?:-[a-z]+)?|Chrome-Lighthouse|altavista|AppEngine-Google|archive.*?\.org_bot|archiver|Ask Jeeves|[Bb]ai[Dd]u[Ss]pider(?:-[A-Za-z]+)*|bingbot|BingPreview|blitzbot|BlogBridge|BoardReader(?: [A-Za-z]+)*|boitho.com-dc|BotSeer|\b\w*favicon\w*\b|\bYeti(?:-[a-z]+)?|Catchpoint bot|[Cc]harlotte|Checklinks|clumboot|Comodo HTTP\(S\) Crawler|Comodo-Webinspector-Crawler|ConveraCrawler|CRAWL-E|CrawlConvera|Daumoa(?:-feedfetcher)?|Feed Seeker Bot|findlinks|Flamingo_SearchEngine|FollowSite Bot|furlbot|Genieo|gigabot|GomezAgent|gonzo1|(?:[a-zA-Z]+-)?Googlebot(?:-[a-zA-Z]+)?|Google SketchUp|grub-client|gsa-crawler|heritrix|HiddenMarket|holmes|HooWWWer|htdig|ia_archiver|ICC-Crawler|Icarus6j|ichiro(?:/mobile)?|IconSurf|IlTrovatore(?:-Setaccio)?|InfuzApp|Innovazion Crawler|InternetArchive|IP2[a-z]+Bot|jbot\b|KaloogaBot|Kraken|Kurzor|larbin|LEIA|LesnikBot|Linguee Bot|LinkAider|LinkedInBot|Lite Bot|Llaut|lycos|Mail\.RU_Bot|masidani_bot|Mediapartners-Google|Microsoft .*? Bot|mogimogi|mozDex|MJ12bot|msnbot(?:-media *)?|msrbot|netresearch|Netvibes|NewsGator[^/]*|^NING|Nutch[^/]*|Nymesis|ObjectsSearch|Orbiter|OOZBOT|PagePeeker|PagesInventory|PaxleFramework|Peeplo Screenshot Bot|PlantyNet_WebRobot|Pompos|Read%20Later|Reaper|RedCarpet|Retreiver|Riddler|Rival IQ|scooter|Scrapy|Scrubby|searchsight|seekbot|semanticdiscovery|Simpy|SimplePie|SEOstats|SimpleRSS|SiteCon|Slurp|snappy|Speedy Spider|Squrl Java|TheUsefulbot|ThumbShotsBot|Thumbshots\.ru|TwitterBot|URL2PNG|Vagabondo|VoilaBot|^vortex|Votay bot|^voyager|WASALive.Bot|Web-sniffer|WebThumb|WeSEE:[A-z]+|WhatWeb|WIRE|WordPress|Wotbox|www\.almaden\.ibm\.com|Xenu(?:.s)? Link Sleuth|Xerka [A-z]+Bot|yacy(?:bot)?|Yahoo[a-z]*Seeker|Yahoo! Slurp|Yandex\w+|YodaoBot(?:-[A-z]+)?|YottaaMonitor|Yowedo|^Zao|^Zao-Crawler|ZeBot_www\.ze\.bz|ZooShot|ZyBorg)(?:[ /]v?(\d+)(?:\.(\d+)(?:\.(\d+))?)?)?", // Bots
    "(?:\/[A-Za-z0-9\.]+)? *([A-Za-z0-9 \-_\!\[\]:]*(?:[Aa]rchiver|[Ii]ndexer|[Ss]craper|[Bb]ot|[Ss]pider|[Cc]rawl[a-z]*))/(\d+)(?:\.(\d+)(?:\.(\d+))?)?", // Bots General matcher 'name/0.0'
    "(?:\/[A-Za-z0-9\.]+)? *([A-Za-z0-9 _\!\[\]:]*(?:[Aa]rchiver|[Ii]ndexer|[Ss]craper|[Bb]ot|[Ss]pider|[Cc]rawl[a-z]*)) (\d+)(?:\.(\d+)(?:\.(\d+))?)?", // Bots General matcher 'name 0.0'
    "((?:[A-z0-9]+|[A-z\-]+ ?)?(?: the )?(?:[Ss][Pp][Ii][Dd][Ee][Rr]|[Ss]crape|[A-Za-z0-9-]*(?:[^C][^Uu])[Bb]ot|[Cc][Rr][Aa][Ww][Ll])[A-z0-9]*)(?:(?:[ /]| v)(\d+)(?:\.(\d+)(?:\.(\d+))?)?)?" // Bots containing spider|scrape|bot(but not CUBOT)|Crawl
]

function checkb() {
    var isBot = false;
    var userAgent = navigator.userAgent;
    if(!userAgent || userAgent.length == 0) 
        return isBot;

    for (var bot of bots) {
        try {
            if(userAgent.match(bot)) {
                isBot = true;
                break;
            }
        } catch(e) {
            console.error(e)
        }
    }
    return isBot;
}

function cfitinit() {
	(function (c, f, i, t, a, b, e) {

		if (!cf_account_enabled) {
			removeCFInvisibleCode();
			console.error("Your CustomFit.ai subscription has been expired. Remove the JS snippet or contact https://customfit.ai/contact")
			return;
		}

		if (cf_skip_sdk) {
			removeCFInvisibleCode();
			console.error("CustomFit.ai sdk has been powered off")
			return;
		}

		if (checkb()) {
			removeCFInvisibleCode();
			return;
		}

		var ele = f.getElementById('customfitinit')
		if (!ele) return;

		var ele_ar = ele.src.split('/');
		cf_dimension_id = ele_ar[ele_ar.length - 2];
		if (ele.src.includes("stage")) {
			cf_setup_env = "stage";
		}

		var spa = cf_spa ? cf_spa : ele.getAttribute('cfspa') == "true";
		var spa_auto_detect_page_url_change = cf_spa_auto_detect_page_url_change ? cf_spa_auto_detect_page_url_change : ele.getAttribute('cfspa_auto_detect_page_url_change') == "true";
		if (c.customFit) {
			if (spa == true) {
				c.customFit.uninit();
			} else {
				console.error("Mutliple initialization of CustomFit ai detected");
				if (c.customFit.documentMadeVisible) {
					removeCFInvisibleCode()
				}
				return;
			}
		}

		var domain_mismatch = false;
		if (!window.location.host.includes(cf_domain_url)) {
			domain_mismatch = true;
			for (var cf_subdomain of cf_subdomains) {
				if (window.location.host.includes(cf_subdomain)) {
					domain_mismatch = false;
					break;
				}
			}
		}

		if (domain_mismatch) {
			console.error("Exiting: CustomFit ai detected the script on a non-configured domain/subdomain. Check https://dashboard.customfit.ai/settings/app-settings");
			removeCFInvisibleCode();
			return;
		}

		var customFit = new CustomFit.default();
		console.log("CustomFit.ai init started! (Version: " + cf_sdk_version + ")");
		ele.insertAdjacentHTML("beforebegin", `<style type="text/css">.customfit-invisible-block{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}</style>`);
		var cfUserBuilder = new CustomFit.CFUser.Builder();
		var cfg = { personalize: true, maintainSession: false, sendPageTrack: true, spa: spa, spa_auto_detect_page_url_change: spa_auto_detect_page_url_change }
		var key = cf_key ? cf_key : ele.getAttribute('cfclientkey')
		if (!key) { console.error("CustomFit init failed! Client key missing!"); return; }
		if (customFit.construct(cfUserBuilder.build(), key, cfg)) {
			customFit.init().then(function (value) {
				var tpl = 'background-color:white; border:3px solid orange; font-size:12px; font-weight: bold;padding:3px 5px;color:';
				console.log('%cWebsite hyper-personalization engine \'CustomFit.ai\' (https://customfit.ai?utm_campaign=console) is at your service - t:' + new Date().getTime(),
					tpl + 'magenta');
			}).catch(function (err) {
				console.log("Error CustomFit.ai", err);
			});
		}
		c.customFit = customFit
	})(window, document);
}

cfitinit();
